"use strict";(self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).push([[209],{1956:(a,b,c)=>{c.d(b,{a:()=>d});let d=!c(1).a.isActivated("66EDC6AE-80AC-4431-B9D9-456A88EB4A33")}
,1631:(a,b,c)=>{let d;function e(){return d||"function"!=typeof BroadcastChannel||(d=new BroadcastChannel("sw_broadcast")),d}c.d(b,{a:()=>g,b:()=>f,c:()=>e});let f={Sync:"Sync",GetSyncStates:"GetSyncStates",Installing:"Installing",Installed:"Installed",TaskCompleted:"TaskCompleted"},g={OfflineNotification:"OfflineNotification",CheckOffline:"CheckOffline",ServiceWorkerRegistered:"ServiceWorkerRegistered",ScriptSynced:"ScriptSynced",ChunkLoadError:"ChunkLoadError",NucleusEndpointUpdated:"NucleusEndpointUpdated"}}
,1270:(a,b,c)=>{c.d(b,{a:()=>f});var d=c(2),e=c(26);let f=new d.a({name:"OneDriveDataSource.async.key",loader:new e.b(()=>Promise.all([c.e("ondemand.resx"),c.e(34),c.e(35),c.e(64),c.e(387)]).then(c.bind(c,2080)).then(a=>a.oneDriveDataSourceKey))})}
,783:(a,b,c)=>{c.r(b),c.d(b,{StsServiceWorkerProxy:()=>J});var d=c(25),e=c(1),f=c(12),g=c(1631),h=c(156),i=c(572),j=c(281);let k="Stream",l="Lists",m={FluentUIV9ShimOverallControl:60077,FluentUIV9ShimDefaultButton:60337,FluentUIV9ShimPrimaryButton:60344,FluentUIV9ShimIconButton:60355,FluentUIV9ShimActionButton:60356,FluentUIV9ShimImage:60357,FluentUIV9ShimToggle:60461,FluentUIV9ShimCommandBarButton:60466,FluentUIV9ShimCommandBar:60480,FluentUIV9ShimCommandButton:60501,FluentUIV9ShimTooltipHost:60634,FluentUIV9ShimTooltip:60633,FluentUIV9ShimLink:60405,FluentUIV9ShimStack:60413,FluentUIV9ShimCheckbox:60414,FluentUIV9ShimDialog:60426,FluentUIV9ShimChoiceGroup:60415,FluentUIV9ShimPersona:60419,FluentUIV9ShimFacepile:60569,FluentUIV9ShimPivot:60105,FluentUIV9ShimContextualMenu:60556,FluentUIV9ShimOverlay:60547,FluentUIV9ShimOverflowSet:60555,FluentUIV9ShimIcon:60446,FluentUIV9ShimSpinner:60450,FluentUIV9ShimSlider:60454,FluentUIV9ShimLayer:60460,FluentUIV9ShimText:60566,FluentUIV9ShimCustomizer:60650,FluentUIV9ShimThemeProvider:60567,FluentUIV9ShimSpinButton:60557,FluentUIV9ShimLabel:60382,FluentUIV9ShimSeparator:60384,FluentUIV9ShimCompoundButton:60540,FluentUIV9ShimTextField:61154,FluentUIV9ShimShimmer:61344,FluentUIV9ShimFocusTrapZone:60457,FluentUIV9ShimFocusZone:61362,FluentUIV9ShimPanel:61363,FluentUIV9ShimProgressIndicator:61364,FluentUIV9ShimDatePicker:61369,FluentUIV9ShimMessageBar:61378,FluentUIV9ShimDropdown:61379,FluentUIV9ShimCallout:61380,FluentUIV9ShimModal:61381,FluentUIV9ShimLayoutGroup:61383,FluentUIV9ShimComboBox:61384,FluentUIV9ShimCard:61385},n={FluentUIV9ShimOverallControl:[60077,"74bd710c-b207-4479-aae3-2c781d0c402c"],FluentUIV9ShimDefaultButton:[60337,"ce6ef6b6-ade6-4341-b31c-074224ae1193"],FluentUIV9ShimPrimaryButton:[60344,"4fd5a361-9970-4eaf-8e42-5c570d22f881"],FluentUIV9ShimIconButton:[60355,"38bb5308-e777-4c5a-8821-bba3e9925d62"],FluentUIV9ShimActionButton:[60356,"b6cc9ad8-4f8d-42d5-a93c-1433f86a47bc"],FluentUIV9ShimImage:[60357,"52356f26-b833-4250-9986-c67ef54fc3a1"],FluentUIV9ShimToggle:[60461,"f506d00c-fc8e-4e02-b439-c03aa8fdd98b"],FluentUIV9ShimCommandBarButton:[60466,"f94e772a-fc76-46e4-bf4d-33f824cca892"],FluentUIV9ShimCommandBar:[60480,"2c2d291f-86ec-4074-8526-b38b84254b22"],FluentUIV9ShimCommandButton:[60501,"6327cfba-6b7a-47f4-96f5-08e954f04078"],FluentUIV9ShimTooltipHost:[60634,"920483f1-9531-49b7-b0db-9079ac51c689"],FluentUIV9ShimTooltip:[60633,"f26b166c-8f39-436c-a50e-54caee00754c"],FluentUIV9ShimLink:[60405,"461441be-33c4-46d4-911b-b60d63cd1289"],FluentUIV9ShimStack:[60413,"a1eafa06-cb77-45d3-87b3-94504fa0388f"],FluentUIV9ShimCheckbox:[60414,"83840aac-44d0-4361-a506-4c8a2d0d14cd"],FluentUIV9ShimDialog:[60426,"25cab316-6165-4675-8584-d2d0caa177da"],FluentUIV9ShimChoiceGroup:[60415,"ede3656e-7ea3-4bff-b02b-b3caea6bafee"],FluentUIV9ShimPersona:[60419,"21f9bb0c-b9fb-4d9e-afb8-19516e635c00"],FluentUIV9ShimFacepile:[60569,"5d9f9301-5cef-42e1-9700-43055c62d4c8"],FluentUIV9ShimPivot:[60105,"2d818ff8-879c-4ad9-b1c2-e5594afff323"],FluentUIV9ShimContextualMenu:[60556,"a44ef38c-cc30-49d5-a166-b142311f5c35"],FluentUIV9ShimOverlay:[60547,"dbe83fbe-1860-4022-8859-cd8937ceecf9"],FluentUIV9ShimOverflowSet:[60555,"11557fe5-bd6b-4e93-9222-28b097122b27"],FluentUIV9ShimIcon:[60446,"0697c807-797b-45da-b5c3-cb83cd1ca86d"],FluentUIV9ShimSpinner:[60450,"ffd8b85e-5dce-491e-bcaf-8923ed253c9e"],FluentUIV9ShimSlider:[60454,"b5d69db9-2679-4854-a6fe-6705db4230a1"],FluentUIV9ShimLayer:[60460,"454bc469-8699-4016-979e-3e172985accb"],FluentUIV9ShimText:[60566,"2725318e-6ee2-437c-b2ce-7b1c152bd008"],FluentUIV9ShimCustomizer:[60650,"aad4daf0-b727-417f-b7d9-c9d6e72f0640"],FluentUIV9ShimThemeProvider:[60567,"ea40dc6a-ec23-4fa1-a2a4-6e89949c9e8b"],FluentUIV9ShimSpinButton:[60557,"b43f0692-acc7-4573-a9c6-a05b2b7ffbac"],FluentUIV9ShimLabel:[60382,"3c6806d2-aaca-478b-a531-ce6e0e579b95"],FluentUIV9ShimSeparator:[60384,"b05b4ee0-b222-4f95-b119-b99ffa803194"],FluentUIV9ShimCompoundButton:[60540,"3a9abc37-c16d-4241-8536-afbf0aacd519"],FluentUIV9ShimTextField:[61154,"6e4adbcc-e41a-425d-8e01-64d493be5a09"],FluentUIV9ShimShimmer:[61344,"1c5e2d4c-f3df-45aa-8575-66489d98b5b0"],FluentUIV9ShimFocusTrapZone:[60457,"48fed914-c7de-4798-8ef7-d97ddc53c973"],FluentUIV9ShimFocusZone:[61362,"3bb1836f-0747-4ea5-9061-e08c265e4b77"],FluentUIV9ShimPanel:[61363,"fee65891-fac6-4d69-b0ad-e637ac5a237d"],FluentUIV9ShimProgressIndicator:[61364,"076da7bb-1fe0-487c-9d6e-c86dead2fa33"],FluentUIV9ShimDatePicker:[61369,"f1d9c5cb-5996-4bdb-8e93-872b5e9ef1f6"],FluentUIV9ShimMessageBar:[61378,"c4122420-877e-4c90-b841-b2838d050c34"],FluentUIV9ShimDropdown:[61379,"66deeef6-2212-47bb-8b48-42eaae5ef5d1"],FluentUIV9ShimCallout:[61380,"44eb70d4-b5f0-4703-846f-c56a30cc4e60"],FluentUIV9ShimModal:[61381,"334dcb3e-b453-4e70-a0d9-1ac16b2a628b"],FluentUIV9ShimLayoutGroup:[61383,"7241ef55-a3ae-445e-b501-2017ed3bb574"],FluentUIV9ShimComboBox:[61384,"c8761703-0637-4022-90fe-28d124f97cb7"],FluentUIV9ShimCard:[61385,"945548b1-4039-4684-bae7-a4b3b392bd74"]},o=[{registration:{id:"STS",swPrefetchManifestName:"stsserviceworkerprefetch"}},{registration:{id:"SPHome"}},{featureIds:[61636],registration:{id:"NextGenSharePoint"}},{featureIds:[1966],registration:{id:"SitePages"}},{featureIds:[61462],experimentIds:[90235],registration:{id:k}},{registration:{id:"Embed"}},{odc:!0,scenarioId:1,featureIds:[],registration:{id:"ODC"}},{registration:{id:"CreateGroup"}},{featureIds:[60155],registration:{id:"SingleWebPart"}},{featureIds:[60840],registration:{id:"VivaHome"}},{featureIds:[60877],registration:{id:"VivaAmplify"}},{registration:{id:"BrokerLogon"}},{scenarioId:2,registration:{id:"TeamsBroker"}},{featureIds:[1344],registration:{id:"Clipchamp"}},{featureIds:[1988],registration:{id:"MeeBridge"}},{featureIds:[61128],registration:{id:"SPStart"}},{featureIds:[1433],registration:{id:"Agreements"}},{featureIds:[61735],registration:{id:"ChatODSP"}},{featureIds:[62304],registration:{id:"PortableComponent"}},{featureIds:[60072],registration:{id:"Foundation"}},{featureIds:[62475],registration:{id:"ODB"}},{featureIds:[62475],registration:{id:l}},{featureIds:[62611],registration:{id:"NewsL2"},experimentIds:[90135]}];async function p(a,b,c,f,g,p){let q,r,{forceOdcServiceWorker:s=!1,isConsumer:t=!1,isOd4UIEnabled:u=!1,shouldHandleAccountSwitching:v=!1}=p||{},w=s||d.d.isFeatureEnabled({ODC:!0}),x=w?1:2*("securebroker.sharepointonline.com"===location.host);f||(f=o.filter(b=>{if(x!==(b.scenarioId||0))return!1;let c=!0;switch(b.featureIds&&b.featureIds.forEach(a=>{c=c&&d.d.isFeatureEnabled(w?{ODC:a}:{ODB:a})}),b.registration.id){case"STS":return c&&!d.d.isFeatureEnabled({ODB:62475})&&1!==(0,h.c)(90371,a)&&!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/);case k:return c||1===(0,h.c)(90235,a);case"ODB":case l:return c||1===(0,h.c)(90371,a)}return c}).map(a=>a.registration));let y=JSON.stringify(f);c||(c=!w&&d.d.isFeatureEnabled({ODB:1966})&&-1!==document.cookie.indexOf("SPClientSideFrameworkDevCookie-9076A2B0-2161-43C6-8BEA-9FECB7EA459B="));let z=e.a.isActivated("EB4018E4-5975-493E-A50B-0BEA4CAFEA5A","05/10/2023","Disable ODC Picker usage of SW"),A=1===(0,h.c)(90235,a),B=[];A&&B.push(90235),d.d.isFeatureEnabled({ODB:62475})||1!==(0,h.c)(90371,a)||B.push(90371);let C=d.d.isFeatureEnabled({ODB:60716}),D=(d.d.isFeatureEnabled({ODB:61462})&&B.push(61462),(d.d.isFeatureEnabled({ODB:62475})||-1!==B.indexOf(90371))&&B.push(62475),{supportsFeatures:B}),E="cf53f55e-5a10-4ee9-b1ed-5b9e47c8787b",F=new URLSearchParams(location?.search),G="true"===F?.get("preWarmFB")&&e.a.isActivated("b9753621-c3bf-48a8-85cd-b16167fa6798","04/28/2025","When this Killswitch is pulled it will unregister the SW and register again on Prewarm"),H=1===(0,h.c)(90164,a),I=1===(0,h.c)(90260,a);return!e.a.isActivated("306a6d77-d4be-4b58-9d59-f7dacfe95e68","2/24/2025")&&window.__swstatsPromise&&await Promise.race([window.__swstatsPromise,new Promise(a=>setTimeout(a,3e3))]),`${w?"/odc":"/_layouts/15/odsp"}serviceworkerproxy.aspx?swManifestName=${w?"odc":2===x?"teamsbroker":"sp"}serviceworker&debug=${c?"true":"false"}&bypass=${b?"true":"false"}`+["AF85BA2D-F9E1-48BC-A323-9500099DFD38","971B8FF3-D4BE-4CA1-A585-B37FC070F11D"].map(a=>e.a.isActivated(a,"4/29/2024","Reinstall killswitches")?`&${a}=true`:"").join("")+(e.a.isActivated(E)?`&${E}=true`:"")+(D?`&navigationPreloadHeaderValue=${encodeURIComponent(JSON.stringify(D))}`:"")+(!e.a.isActivated("A3237807-93B8-4156-8BED-4637E19E6003")&&!w&&t&&p?.userId?`&userId=${p.userId}`:a?.aadUserId?`&userId=${a.aadUserId}`:"")+`${0===x&&d.d.isFeatureEnabled({ODB:1235})?"&dataHost=Nucleus":""}`+`&applications=${encodeURIComponent(y)}`+`${0===x&&d.d.isFeatureEnabled({ODB:61590})?"&prefetchListData=true":""}`+`${0===x&&d.d.isFeatureEnabled({ODB:1878})&&HTMLScriptElement.supports&&HTMLScriptElement.supports("webbundle")?"&spHomeWebBundle=true":""}`+`${d.d.isFeatureEnabled({ODB:60734})?"&defaultBrotli=true":""}`+`${d.d.isFeatureEnabled({ODC:"EnableSwJsCaching"})?"&cacheResources=true":""}`+`${z?"&disablePickerSw=true":""}`+`${d.d.isFeatureEnabled({ODB:60078})?"&authenticateFast=true":""}`+`${d.d.isFeatureEnabled({ODB:61296})?"&inlineAuth=v2":""}`+"&wwData=true"+`${d.d.isFeatureEnabled({ODB:60315})?"&prefetchFilebrowserPageInTeams=true":""}`+`${d.d.isFeatureEnabled({ODB:60815})?`&${function(){let a=Array((Object.keys(m).length>>5)+1).fill(0),b=0;for(let c in n)if(n.hasOwnProperty(c)){let f=b>>5;!e.a.isActivated(n[c][1],"12/20/2023","Check component KS before add flights to FUI array")&&d.d.isFeatureEnabled({ODB:n[c][0]})&&(a[f]|=1<<(31&b)),b++}return`FUIV9Flights=[${a.join()}]`}()}`:""}`+`${0===x&&HTMLScriptElement.supports&&HTMLScriptElement.supports("webbundle")?"&spStartApplicationWebBundle=true":""}`+`${d.d.isFeatureEnabled({ODB:62758})?"&missingLinksSW=true":""}`+`${d.d.isFeatureEnabled({ODB:62759})?"&missingLinksCrossSite=true":""}`+`${d.d.isFeatureEnabled({ODB:60737})?"&enableIntegrities=true":""}`+`${d.d.isFeatureEnabled({ODB:61391})?"&useNucleusCDN=true":(0,h.a)(90341,a)>0?"&nucleusCDNExperimentTreatment=true":""}`+`${d.d.isFeatureEnabled({ODB:1781})?"&expTeamsUnexpectedErr=true":""}`+`${d.d.isFeatureEnabled({ODB:61556})?"&forceNucleusCDN=true":""}`+`${d.d.isFeatureEnabled({ODB:62022})?"&useNucleusComponentRegistry=true":1===(0,h.a)(90001,a)?"&nucleusCDNV2ExperimentTreatment=true":""}`+`${d.d.isFeatureEnabled({ODB:61636})?"&nextgen=true":""}`+`${g?`&currentUserOdbMySitePath=${encodeURIComponent(g)}`:""}`+`${d.d.isFeatureEnabled({ODB:61462})||A?"&swaOfflineStart=true":""}`+`${d.d.isFeatureEnabled({ODB:-61772})?"&enableNucleusFileBrowserSupport=true":""}`+`${C?"&spartanOneDriveWireframe=true":""}`+`${d.d.isFeatureEnabled({ODB:61775})?"&enableVHSourceOriginRedirect=true":""}`+`${d.d.isFeatureEnabled({ODB:61612})||I?"&streamViewServerLoad=true":""}`+`${d.d.isFeatureEnabled({ODB:60070})||H?"&streamInlineScript=true":""}`+`${d.d.isFeatureEnabled({ODB:62079})?"&compWWFlow=true":""}`+`${!d.d.isFeatureEnabled({ODB:61585})?"&fab=true":""}`+`&g=${window.__swstats?.generation||navigator.serviceWorker?.controller?.scriptURL&&+new URL(navigator.serviceWorker.controller.scriptURL).searchParams.get("g")||0}`+`${d.d.isFeatureEnabled({ODB:60036})?"&redirect=v2":""}`+`${d.d.isFeatureEnabled({ODB:62150})?"&swFetchDurationQos=true":""}`+`${!e.a.isActivated("c86f1379-4f8a-44ca-8483-160d64a5d8e7")?"&SupportShareDialogJSCaching=true":""}`+`${w&&!e.a.isActivated("48985f98-4a4c-4ac8-b6ed-6522dca05e82")?"&odcPhotosFetchFallback=true":""}`+`${d.d.isFeatureEnabled({ODB:62802})?"&IDBAutoHeal=true":""}`+`${(q=!e.a.isActivated("19692802-34a4-4e43-bec8-504bcf9bbc80","04/15/2025","enabling new regex for teams."),/Teams\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+))(?:\/(\d+))?/.test(navigator.userAgent)||q&&/Teams\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+))(\S*)?/.test(navigator.userAgent))?"&teamsDesktopClient=true":""}`+`${document.cookie.includes("srr=")||document.cookie.includes("devmode=true")?"&dev=true":""}`+`${G?"&deRegisterSWPrewarm=true":""}`+`${w&&e.a.isActivated("4BE0FD7F-8411-4A12-AADF-CF634CF78FEF")?"&disableSettingsBypass=true":""}`+`${w&&e.a.isActivated("8E9C2D7D-7CEC-4246-9D40-409E55606FC2")?"&disableCacheLs=true":""}`+`${w&&d.d.isFeatureEnabled({ODB:62355})?"&enableODBCFastOneUp=true":""}`+`${!e.a.isActivated("9B608A1D-8F89-4F53-8F01-43E09E427556")?function(a){let b="";if(a){let c=(0,i.b)(a);c&&(b=`&environment=${c}`)}return b}(a):""}`+`${w&&!e.a.isActivated("D1B26108-0D57-4E49-ABC0-72F6C65A5109")?"&enableOdbcSwV1=true":""}`+`${w&&!e.a.isActivated("99D1B08E-67ED-4620-B2FC-318384CD33B8")?"&checkPhotosSWParam=true":""}`+`${!e.a.isActivated("17A58740-E797-46F7-A49F-AA317833EE54")&&!w&&t?"&isConsumer=true":""}`+`${!e.a.isActivated("68BFAE6A-AEA9-4E97-98AD-60A1A79B946F")&&p?.disableNavigationPreload?"&disableNavigationPreload=true":""}`+`${!e.a.isActivated("AD517E2C-3914-4E92-BD46-822E8D7E3C9E")&&u?"&isOd4UIEnabled=true":""}`+`${w&&!e.a.isActivated("A2A03C87-8ECB-4EEE-9339-B2473A493B72")?"&skipPhotosAuth=true":""}`+`${w&&e.a.isActivated("9C54D0EF-395E-4AD1-8F70-4D657554876B")?"&enableOdbController=true":""}`+`${e.a.isActivated("46EA2CE2-DA8E-40AE-84CD-FADFE603F147")?"&ksInferConsumerScenarioFromUrl=true":""}`+`${!e.a.isActivated("CA6B000B-0252-43E2-A27A-873B9D84A616")?(r="",d.d.isFeatureEnabled({ODB:61878})&&(r+="&spartanFileBrowserEnabled=true"),d.d.isFeatureEnabled({ODB:61981})&&(r+="&appHomeSpartanFileBrowserEnabled=true"),(d.d.isFeatureEnabled({ODB:62366})||1===(0,h.c)(90348,a))&&(r+="&spartanTeamsListsFileBrowserEnabled=true"),d.d.isFeatureEnabled({ODB:62417})&&(r+="&spartanTeamsListsFileBrowserScenarioEnabled=true"),(d.d.isFeatureEnabled({ODB:62030})||1===(0,h.c)(90349,a))&&(r+="&spartanDocLibTeamsSPFileBrowserEnabled=true"),d.d.isEcsFeatureEnabled({ECS:j.a.EcsClientFlightInfo.FileBrowserWorkspaceEnabled})&&(r+="&fileBrowserWorkspaceEnabled=true"),r):""}`+`${!e.a.isActivated("1D48F272-70E7-4CB8-8A1C-9B7F73742673")&&v?"&shouldHandleAccountSwitching=true":""}`+`${!e.a.isActivated("d71be65d-2b80-4ce7-b0a8-f68d16f3e8cb")&&(d.d.isFeatureEnabled({ODB:60001})||d.d.isFeatureEnabled({ODB:60933}))?"&announcementsWP=true":""}`+`${(e.a.isActivated("FB4C0F88-F984-4EF8-BBBB-BFD3A24B99C9")?navigator.userAgent.includes("OneDrivePhotos/"):/OneDrivePhotos\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+))(?:\/(\d+))?/.test(navigator.userAgent))?"&photosDesktopClient=true":""}`+`${w&&!e.a.isActivated("A7F7B11C-836C-436E-B252-3F0337520EF1")?"&ignoreJsonResponseInOdcSwV1=true":""}`}let q=e.a.isActivated("669BDA54-62B3-4FDC-9FD3-541981584CE5","09/13/2023"),r=e.a.isActivated("2C88EA6E-7255-40B5-9054-0EF53C191099"),s=e.a.isActivated("EC159A83-CD4F-4FD0-8260-9A64C281AB27"),t=q?void 0:{resultType:f.b.ExpectedFailure,error:"Not supported"};class u{addListener(a){this._listeners.add(a)}removeListener(a){this._listeners.delete(a)}async register(a,b,c,e,f){if(!v())return Promise.reject(t);let g=await p(a,b,c,e,f);return navigator.serviceWorker.register(g,{scope:"/",updateViaCache:d.d.isFeatureEnabled({ODB:1846})?"all":"none"})}registerAt(a,b,c,d,e){return v()?Promise.resolve(a).catch(()=>void 0).then(a=>{if(!a?.length)return;let f=[],h=-1!==a.indexOf(location.hostname);h&&(r?f.push(this.register({}).then()):f.push(this.register(b,c,d,void 0,e).then()));let i=h?a.length-1:a.length;for(let j of(f.push(i&&new Promise(a=>{let b=c=>{c.data.name===g.a.ServiceWorkerRegistered&&(document.getElementById(`register-service-worker-${c.data.host}`)?.remove(),--i||(removeEventListener("message",b),a()))};addEventListener("message",b)})),a)){if(!s&&-1!==j.indexOf("http"))try{j=new URL(j).hostname}catch{}if(!h||j!==location.hostname){let a=p(b,c,d,void 0,e),f=`https://${j}/_layouts/15/RegisterServiceWorker.ashx${new URL(`https://${j}${a}`).search}`,g=document.createElement("iframe");g.name="register-service-worker",g.id=`register-service-worker-${j}`,g.src=f,g.hidden=!0,g.style.display="none",document.body.appendChild(g)}}return Promise.all(f).then()}):Promise.reject(t)}unregister(){return v()?navigator.serviceWorker.getRegistrations().then(a=>{Promise.all(a.map(a=>a.unregister()))}):Promise.reject(t)}send(a){if(!v()||!navigator.serviceWorker.controller)return;let b=JSON.stringify(a);navigator.serviceWorker.controller.postMessage(b)}sendAndReceiveReply(a){return v()&&navigator.serviceWorker.controller?new Promise((b,c)=>{let d=new MessageChannel;d.port1.onmessage=a=>{let d=a.data;d.error?c(d.error):b(a.data)};let e=JSON.stringify(a);navigator.serviceWorker.controller.postMessage(e,[d.port2])}):Promise.reject(void 0)}sync(a){return v()?navigator.serviceWorker.ready.then(b=>b.sync.register(JSON.stringify(a))):Promise.reject(t)}dispose(){v()&&navigator.serviceWorker.removeEventListener("message",this._onMessage)}constructor(){this._listeners=new Set,this._onMessage=a=>{let b=a.data;this._listeners.forEach(a=>{a(b)})},v()&&navigator.serviceWorker.addEventListener("message",this._onMessage)}}function v(){return"serviceWorker"in navigator}var w=c(616),x=c(1956),y=c(1270);let z=!e.a.isActivated("1C1287BE-E4F2-40A7-8F4D-9F4F87245AF2"),A=!e.a.isActivated("BA806250-8958-4941-8405-AE88AD4001DD"),B="/_layouts/15/onedrive.aspx";async function C(a,b,c){let d;if(!a||(0,w.a)(a)||x.a&&a.isUnauthenticated)return;if(a.isMySiteOwner&&a.webServerRelativeUrl&&(z||a.serverRequestPath))return{webAbsoluteUrl:a.webAbsoluteUrl,odbMySitePath:`${a.webServerRelativeUrl}${B}`};if(A)d=await c();else{if(!b)return;d=await b.consumeAsync(y.a)}let e=await d.getPersonalUrl(),f=new URL(e);return{webAbsoluteUrl:e,odbMySitePath:`${f.pathname}${B}`}}var D=c(68),E=c(383),F=c(233),G=c(200);let H=!e.a.isActivated("CFF68108-5E91-4F81-831D-AAC1015A9BD5");function I(){return E.a.consumeAsync(y.a)}class J extends u{async register(a,b,c,d){let f;try{var g;let b=E.a.consume(D.b);!e.a.isActivated("860f8921-be9a-4ed3-a6b8-861cfbfc3e4b")&&b&&(a=b),f=H&&(g=b)&&Number(g.webTemplate)===G.a.mySite&&Number(g.listBaseTemplate)===F.a.mySiteDocumentLibrary?(await C(b,E.a,I))?.odbMySitePath:void 0}catch(a){}return super.register(a,b,c,d,f)}}}
}]),define("odsp-next-swproxy",[],{});