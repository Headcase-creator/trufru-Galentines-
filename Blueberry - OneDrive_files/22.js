"use strict";(self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).push([[22],{1049:(a,b,c)=>{c.d(b,{a:()=>w});var d=c(10),e=c(0),f=c(59),g=c(197),h=c(194),i=c(132),j=c(62),k=c(94),l=c(105),m=c(13),n=c(227),o=c(229),p=c(131),q=c(196),r=c(195),s="data-selection-index",t="data-selection-toggle",u="data-selection-invoke",v="data-selection-all-toggle",w=function(a){function b(b){var c=a.call(this,b)||this;c._root=e.createRef(),c.ignoreNextFocus=function(){c._handleNextFocus(!1)},c._onSelectionChange=function(){var a=c.props.selection,b=a.isModal&&a.isModal();c.setState({isModal:b})},c._onMouseDownCapture=function(a){var b=a.target,d=(0,f.a)(c._root.current),e=null==d?void 0:d.document;if((null==e?void 0:e.activeElement)!==b&&!(0,g.a)(null==e?void 0:e.activeElement,b))return void c.ignoreNextFocus();if((0,g.a)(b,c._root.current))for(;b!==c._root.current;){if(c._hasAttribute(b,u)){c.ignoreNextFocus();break}b=(0,h.a)(b)}},c._onFocus=function(a){var b=a.target,d=c.props.selection,e=c._isCtrlPressed||c._isMetaPressed,f=c._getSelectionMode();if(c._shouldHandleFocus&&f!==r.c.none){var g=c._hasAttribute(b,t),h=c._findItemRoot(b);if(!g&&h){var i=c._getItemIndex(h);void 0===c._getItemSpan(h)&&(e?(d.setIndexSelected(i,d.isIndexSelected(i),!0),c.props.enterModalOnTouch&&c._isTouch&&d.setModal&&(d.setModal(!0),c._setIsTouch(!1))):c.props.isSelectedOnFocus&&c._onItemSurfaceClick("focus",i))}}c._handleNextFocus(!1)},c._onMouseDown=function(a){c._updateModifiers(a);var b=c.props.toggleWithoutModifierPressed,d=a.target,e=c._findItemRoot(d);if(!c._isSelectionDisabled(d))for(;d!==c._root.current&&!c._hasAttribute(d,v);){if(e)if(c._hasAttribute(d,t))break;else if(c._hasAttribute(d,u))break;else if(!(d===e||c._shouldAutoSelect(d))||c._isShiftPressed||c._isCtrlPressed||c._isMetaPressed||b){if(c.props.disableAutoSelectOnInputElements&&("A"===d.tagName||"BUTTON"===d.tagName||"INPUT"===d.tagName))return}else{c._onInvokeMouseDown(a,c._getItemIndex(e),c._getItemSpan(e));break}d=(0,h.a)(d)}},c._onTouchStartCapture=function(a){c._setIsTouch(!0)},c._onClick=function(a){var b=c.props.enableTouchInvocationTarget,d=void 0!==b&&b;c._updateModifiers(a);for(var e=a.target,f=c._findItemRoot(e),g=c._isSelectionDisabled(e);e!==c._root.current;){if(c._hasAttribute(e,v)){g||c._onToggleAllClick(a);break}if(f){var i=c._getItemIndex(f),j=c._getItemSpan(f);if(c._hasAttribute(e,t)){g||(c._isShiftPressed?c._onItemSurfaceClick("click",i,j):c._onToggleClick(a,i,j));break}if(c._isTouch&&d&&c._hasAttribute(e,"data-selection-touch-invoke")||c._hasAttribute(e,u)){void 0===j&&c._onInvokeClick(a,i);break}if(e===f){g||c._onItemSurfaceClick("click",i,j);break}if("A"===e.tagName||"BUTTON"===e.tagName||"INPUT"===e.tagName)return}e=(0,h.a)(e)}},c._onContextMenu=function(a){var b=a.target,d=c.props,e=d.onItemContextMenu,f=d.selection;if(e){var g=c._findItemRoot(b);if(g){var h=c._getItemIndex(g);c._onInvokeMouseDown(a,h),e(f.getItems()[h],h,a.nativeEvent)||a.preventDefault()}}},c._onDoubleClick=function(a){var b=a.target,d=c.props.onItemInvoked,e=c._findItemRoot(b);if(e&&d&&!c._isInputElement(b)){for(var f=c._getItemIndex(e);b!==c._root.current&&!(c._hasAttribute(b,t)||c._hasAttribute(b,u));){if(b===e){c._onInvokeClick(a,f);break}b=(0,h.a)(b)}b=(0,h.a)(b)}},c._onKeyDownCapture=function(a){c._updateModifiers(a),c._handleNextFocus(!0)},c._onKeyDown=function(a){c._updateModifiers(a);var b=a.target,d=c._isSelectionDisabled(b),e=c.props,f=e.selection,g=e.selectionClearedOnEscapePress,j=a.which===i.a.a&&(c._isCtrlPressed||c._isMetaPressed),k=a.which===i.a.escape;if(!c._isInputElement(b)){var l=c._getSelectionMode();if(j&&l===r.c.multiple&&!f.isAllSelected()){d||f.setAllSelected(!0),a.stopPropagation(),a.preventDefault();return}if(g&&k&&f.getSelectedCount()>0){d||f.setAllSelected(!1),a.stopPropagation(),a.preventDefault();return}var m=c._findItemRoot(b);if(m)for(var n=c._getItemIndex(m),o=c._getItemSpan(m);b!==c._root.current&&!c._hasAttribute(b,t);){if(c._shouldAutoSelect(b)){d||void 0!==o||c._onInvokeMouseDown(a,n,o);break}if((a.which===i.a.enter||a.which===i.a.space)&&("BUTTON"===b.tagName||"A"===b.tagName||"INPUT"===b.tagName||"SUMMARY"===b.tagName))return!1;if(b===m){if(a.which===i.a.enter){void 0===o&&(c._onInvokeClick(a,n),a.preventDefault());return}if(a.which===i.a.space){d||c._onToggleClick(a,n,o),a.preventDefault();return}break}b=(0,h.a)(b)}}},c._events=new j.a(c),c._async=new k.a(c),(0,l.a)(c);var d=c.props.selection;return c.state={isModal:d.isModal&&d.isModal()},c}return(0,d.g)(b,a),b.getDerivedStateFromProps=function(a,b){var c=a.selection.isModal&&a.selection.isModal();return(0,d.a)((0,d.a)({},b),{isModal:c})},b.prototype.componentDidMount=function(){var a=(0,f.a)(this._root.current),b=null==a?void 0:a.document;this._events.on(a,"keydown, keyup",this._updateModifiers,!0),this._events.on(b,"click",this._findScrollParentAndTryClearOnEmptyClick),this._events.on(null==b?void 0:b.body,"touchstart",this._onTouchStartCapture,!0),this._events.on(null==b?void 0:b.body,"touchend",this._onTouchStartCapture,!0),this._events.on(this.props.selection,"change",this._onSelectionChange)},b.prototype.render=function(){var a=this.state.isModal;return e.createElement("div",{className:(0,m.a)("ms-SelectionZone",this.props.className,{"ms-SelectionZone--modal":!!a}),ref:this._root,onKeyDown:this._onKeyDown,onMouseDown:this._onMouseDown,onKeyDownCapture:this._onKeyDownCapture,onClick:this._onClick,role:"presentation",onDoubleClick:this._onDoubleClick,onContextMenu:this._onContextMenu,onMouseDownCapture:this._onMouseDownCapture,onFocusCapture:this._onFocus,"data-selection-is-modal":!!a||void 0},this.props.children,e.createElement(n.b,null))},b.prototype.componentDidUpdate=function(a){var b=this.props.selection;b!==a.selection&&(this._events.off(a.selection),this._events.on(b,"change",this._onSelectionChange))},b.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose()},b.prototype._isSelectionDisabled=function(a){if(this._getSelectionMode()===r.c.none)return!0;for(;a!==this._root.current;){if(this._hasAttribute(a,"data-selection-disabled"))return!0;a=(0,h.a)(a)}return!1},b.prototype._onToggleAllClick=function(a){var b=this.props.selection;this._getSelectionMode()===r.c.multiple&&(b.toggleAllSelected(),a.stopPropagation(),a.preventDefault())},b.prototype._onToggleClick=function(a,b,c){var d=this.props.selection,e=this._getSelectionMode();if(d.setChangeEvents(!1),this.props.enterModalOnTouch&&this._isTouch&&(void 0!==c?!d.isRangeSelected(b,c):!d.isIndexSelected(b))&&d.setModal&&(d.setModal(!0),this._setIsTouch(!1)),e===r.c.multiple)void 0!==c?d.toggleRangeSelected(b,c):d.toggleIndexSelected(b);else if(e!==r.c.single)return void d.setChangeEvents(!0);else if(void 0===c||1===c){var f=d.isIndexSelected(b),g=d.isModal&&d.isModal();d.setAllSelected(!1),d.setIndexSelected(b,!f,!0),g&&d.setModal&&d.setModal(!0)}d.setChangeEvents(!0),a.stopPropagation()},b.prototype._onInvokeClick=function(a,b){var c=this.props,d=c.selection,e=c.onItemInvoked;e&&(e(d.getItems()[b],b,a.nativeEvent),a.preventDefault(),a.stopPropagation())},b.prototype._onItemSurfaceClick=function(a,b,c){var d,e=this.props,f=e.selection,g=e.toggleWithoutModifierPressed,h=this._isCtrlPressed||this._isMetaPressed,i=this._getSelectionMode();i===r.c.multiple?this._isShiftPressed&&!this._isTabPressed?void 0!==c?null==(d=f.selectToRange)||d.call(f,b,c,!h):f.selectToIndex(b,!h):"click"===a&&(h||g)?void 0!==c?f.toggleRangeSelected(b,c):f.toggleIndexSelected(b):this._clearAndSelectIndex(b,c):i===r.c.single&&this._clearAndSelectIndex(b,c)},b.prototype._onInvokeMouseDown=function(a,b,c){var d=this.props.selection;if(void 0!==c){if(d.isRangeSelected(b,c))return}else if(d.isIndexSelected(b))return;this._clearAndSelectIndex(b,c)},b.prototype._findScrollParentAndTryClearOnEmptyClick=function(a){var b=(0,f.a)(this._root.current),c=null==b?void 0:b.document,d=(0,o.e)(this._root.current);this._events.off(c,"click",this._findScrollParentAndTryClearOnEmptyClick),this._events.on(d,"click",this._tryClearOnEmptyClick),(d&&a.target instanceof Node&&d.contains(a.target)||d===a.target)&&this._tryClearOnEmptyClick(a)},b.prototype._tryClearOnEmptyClick=function(a){!this.props.selectionPreservedOnEmptyClick&&this._isNonHandledClick(a.target)&&this.props.selection.setAllSelected(!1)},b.prototype._clearAndSelectIndex=function(a,b){var c,d=this.props,e=d.selection,f=d.selectionClearedOnSurfaceClick;if(!((void 0===b||1===b)&&1===e.getSelectedCount()&&e.isIndexSelected(a))&&(void 0===f||f)){var g=e.isModal&&e.isModal();e.setChangeEvents(!1),e.setAllSelected(!1),void 0!==b?null==(c=e.setRangeSelected)||c.call(e,a,b,!0,!0):e.setIndexSelected(a,!0,!0),(g||this.props.enterModalOnTouch&&this._isTouch)&&(e.setModal&&e.setModal(!0),this._isTouch&&this._setIsTouch(!1)),e.setChangeEvents(!0)}},b.prototype._updateModifiers=function(a){this._isShiftPressed=a.shiftKey,this._isCtrlPressed=a.ctrlKey,this._isMetaPressed=a.metaKey;var b=a.keyCode;this._isTabPressed=!!b&&b===i.a.tab},b.prototype._findItemRoot=function(a){for(var b=this.props.selection;a!==this._root.current;){var c=a.getAttribute(s),d=Number(c);if(null!==c&&d>=0&&d<b.getItems().length)break;a=(0,h.a)(a)}if(a!==this._root.current)return a},b.prototype._getItemIndex=function(a){var b,c=parseInt(null!=(b=a.getAttribute(s))?b:"",10);return isNaN(c)?-1:c},b.prototype._getItemSpan=function(a){var b,c=parseInt(null!=(b=a.getAttribute("data-selection-span"))?b:"",10);return isNaN(c)?void 0:c},b.prototype._shouldAutoSelect=function(a){return this._hasAttribute(a,"data-selection-select")},b.prototype._hasAttribute=function(a,b){for(var c=!1;!c&&a!==this._root.current;){var d=a.getAttribute(b);if("false"===d){c=!1;break}c="true"===d,a=(0,h.a)(a)}return c},b.prototype._isInputElement=function(a){return"INPUT"===a.tagName||"TEXTAREA"===a.tagName||"true"===a.getAttribute("contenteditable")||""===a.getAttribute("contenteditable")},b.prototype._isNonHandledClick=function(a){var b=(0,p.a)();if(b&&a)for(;a&&a!==b.documentElement;){if((0,q.n)(a)||a.hasAttribute("data-selection-index"))return!1;a=(0,h.a)(a)}return!0},b.prototype._handleNextFocus=function(a){var b=this;this._shouldHandleFocusTimeoutId&&(this._async.clearTimeout(this._shouldHandleFocusTimeoutId),this._shouldHandleFocusTimeoutId=void 0),this._shouldHandleFocus=a,a&&this._async.setTimeout(function(){b._shouldHandleFocus=!1},100)},b.prototype._setIsTouch=function(a){var b=this;this._isTouchTimeoutId&&(this._async.clearTimeout(this._isTouchTimeoutId),this._isTouchTimeoutId=void 0),this._isTouch=!0,a&&this._async.setTimeout(function(){b._isTouch=!1},300)},b.prototype._getSelectionMode=function(){var a=this.props.selection,b=this.props.selectionMode;return void 0===b?a?a.mode:r.c.none:b},b.defaultProps={isSelectedOnFocus:!0,toggleWithoutModifierPressed:!1,selectionMode:r.c.multiple,selectionClearedOnEscapePress:!0},b}(e.Component)}
}]),define("shared-split-bundle~d28943f9",[],{});