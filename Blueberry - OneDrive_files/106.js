"use strict";(self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).push([[106],{1176:(a,b,c)=>{var d,e,f,g,h,i,j,k,l,m;c.d(b,{a:()=>f,b:()=>d}),(i=d||(d={}))[i.none=0]="none",i[i.standard=1]="standard",i[i.compact=2]="compact",i[i.minimal=3]="minimal",i[i.extended=4]="extended",(j=e||(e={}))[j.left=0]="left",j[j.middle=1]="middle",j[j.right=2]="right",(k=f||(f={}))[k.right=0]="right",k[k.middle=1]="middle",k[k.left=2]="left",(l=g||(g={}))[l.unknown=-1]="unknown",l[l.white=0]="white",l[l.black=1]="black",l[l.lightGradient=2]="lightGradient",l[l.darkGradient=3]="darkGradient",(m=h||(h={}))[m.topToBottom=0]="topToBottom",m[m.bottomToTop=1]="bottomToTop",m[m.leftToRight=2]="leftToRight",m[m.rightToLeft=3]="rightToLeft"}
,669:(a,b,c)=>{c.d(b,{a:()=>d});let d={None:0,PrivateChannel:1,SharedChannel:2,StandardChannel:3}}
,1970:(a,b,c)=>{c.d(b,{a:()=>f,b:()=>e});var d=c(12);function e(a,b,c){if(!a||!a.ClientData)return void b.end({resultType:d.b.ExpectedFailure,error:"NoNavBarData or NoClientData",extraData:c?{systemUserKey:c?.systemUserKey}:{}});try{let e=JSON.parse(a.ClientData),f={isGuestMode:e.IsGuestMode,isDarkMode:e.IsDarkMode,puid:e.PUID,systemUserKey:c?.systemUserKey};b.end({resultType:d.b.Success,extraData:f})}catch(a){b.end({resultType:d.b.Failure,error:a,extraData:{systemUserKey:c?.systemUserKey}})}}function f(a){let{baseUrl:b,cultureName:c}=a;return`${b}/_layouts/15/online/handlers/SpoSuiteLinks.ashx?Locale=${c}&v=2&msajax=1&cv=2`}}
,1212:(a,b,c)=>{c.d(b,{a:()=>e,b:()=>k,c:()=>j,d:()=>m,e:()=>l});var d,e,f=c(25),g=c(1);c(1176),c(669);let h=g.a.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),i="undefined"!=typeof window&&f.d.isFeatureEnabled({ODB:1737});function j(a){let{webAbsoluteUrl:b,webServerRelativeUrl:c,isSiteListsHost:d}=a;return"/"===c||""===c||!h&&d||i&&a?.isUnifiedAdminUrl?b:b.substring(0,b.lastIndexOf(c))}function k(a){return"/"===a.webServerRelativeUrl?"":a.webServerRelativeUrl}function l(a){return a&&!!a.groupId&&a.webAbsoluteUrl===a.siteAbsoluteUrl}function m(a){return!!(a.isAnonymousGuestUser||a.isExternalGuestUser||a.isEmailAuthenticationGuestUser||a.isNativeFederatedUser)}(d=e||(e={}))[d.FooterEnabled=2]="FooterEnabled",d[d.MegaMenuEnabled=128]="MegaMenuEnabled",d[d.FooterEmphasis0=256]="FooterEmphasis0",d[d.FooterEmphasis1=512]="FooterEmphasis1",d[d.FooterLayout0=1024]="FooterLayout0",d[d.FooterLayout1=2048]="FooterLayout1",d[d.HideTitleInHeader=0x2000000]="HideTitleInHeader",d[d.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"}
,1385:(a,b,c)=>{c.d(b,{a:()=>d});class d{_serialize(){let a={};return this._features.forEach((b,c)=>{a[c]={Version:b.version,Enabled:b.enabled}}),a}get(a){if(!a||a&&0===a.length)throw Error("Cannot get feature, featureName input is empty or undefined");return this._features.get(a)}constructor(a){if(this._features=new Map,!a)throw Error("Cannot create SPFeatureInfo object, incoming data is undefined.");for(const b in a)if(void 0!==b){const c=a[b];this._features.set(b,{version:c.Version,enabled:c.Enabled})}}}}
,1134:(a,b,c)=>{c.d(b,{a:()=>o,b:()=>q,c:()=>p});var d=c(27),e=c(130),f=c(25),g=c(154),h=c(100),i=c(65),j=c(1384),k=c(1135),l=c(455),m=c(1939),n=c(1);class o{get suiteNavPlaceholder(){return this._suiteNavPlaceholder}set suiteNavPlaceholder(a){this._suiteNavPlaceholder||(this._suiteNavPlaceholder=a)}getCapabilities(){return this._capabilities}getO365Shell(){if(!this._capabilities.supportsRealSuiteNav)return d.c.reject(Error("getO365Shell is only supported if supportsRealSuiteNav capability is true."));if(f.d.isFeatureEnabled({ODB:!0,ODC:!1})){let a=new k.a;return d.c.resolve().then(m.a.GetLoadPromise).then(()=>a)}return this._getO365ShellViaBootstrapper()}getInitialRenderNavBarData(){return this._dataSourceBasic.getInitialRenderNavBarData()}getCachedData(){let a;if(this._capabilities.supportsCaching&&this._isCacheValid()){let b=this._cache.getValue(this._cacheDataKey);a=b&&b.data}return a}getCachedThemeData(){let a;if(this._capabilities.supportsCaching){let b=this._cache.getValue(this._cacheThemeDataKey);b&&b.themeData&&(a=b.themeData)}return a}updateCachedThemeData(a){let b={themeData:a,cacheDate:new Date().toISOString()};this._cache.setValue(this._cacheThemeDataKey,b)}_getO365ShellViaBootstrapper(){let a=new e.b,b=this._qosEvents&&this._qosEvents[l.a.GET_O365_SHELL];return this._getSuiteNavShellViaBootstrapper(a),a.getPromise().then(()=>{this._qosRecordSuccess(b)},a=>{this._qosRecordError(b,a)}),a.getPromise()}_requestShellCore(a,b,c){let d=b?a+"?odb_cb="+new Date().toISOString():a,f=new e.b,g="SuiteNavShellCore";return this._require(d,g,a=>{c&&c();let b=new k.a;b.Exists()?f.complete(b):f.error(p({error:{message:"O365Shell not defined after require() succeeded"},resultCode:"O365ShellNotDefined",extraData:{shellUrl:d}}))},(a,b)=>{o.removeHeadScriptElement(g),f.error(p({error:b||a.message,resultCode:"LoadScriptError",extraData:{shellUrl:d}}))}),f.getPromise()}static removeHeadScriptElement(a){let b=document.head.querySelector("#"+a);b&&b.parentNode.removeChild(b)}_isGuestModeNavData(a){if(!a)return!1;try{let b=a.ClientData&&JSON.parse(a.ClientData);return b&&b.IsGuestMode}catch(a){return!0}}_isCacheValid(){let a=this._cache.getValue(this._cacheDataKey),b=this._cache.getValue(this._cacheVersionKey),c=Date.parse(this._cache.getValue(this._cacheDateKey)),d=this._capabilities.supportsRealSuiteNav,e=this._dataSourceBasic;return a&&a.data&&(this._stopCachingGuestModeNavDataKSActivated||!this._isGuestModeNavData(a.data))&&(!d||a.jsUrl)&&b===this._cacheVersion&&a.userIdentifier===e.getUserIdentifier()&&a.cacheToken===e.getCacheToken()&&this._isSameUserLanguage(a.data.CultureName)&&this._isCacheNotExpired(c,this._cacheExpire)}_qosRecordSuccess(a){a&&a.end({resultType:g.a.Success})}_qosRecordError(a,b){a&&a.end(p({error:b}))}_logEngagementData(a){this._engagementEvent&&this._engagementEvent.logData(a)}_isSameUserLanguage(a){return!(!n.a.isActivated("3e9c64de-101f-4c42-8514-06ef6dd97edb","08/09/2023","Fix language not updated in Feedback and Help section")&&a&&this._pageContext?.currentUICultureName)||a.toLowerCase()===this._pageContext.currentUICultureName.toLowerCase()}_isCacheNotExpired(a,b){return!isNaN(a)&&Date.now()-a<60*b*6e4}_getSuiteNavShellViaBootstrapper(a,b){let c=this._dataSourceBasic.getReactShellBootstrapperUrl();this._requestShellCore(c,b).then(b=>{a.complete(b)},b=>{b=p({error:b}),this._hasRetriedO365Shell?a.error(b):(this._hasRetriedO365Shell=!0,this._getSuiteNavShellViaBootstrapper(a,!0))})}static require(a,b,c,d){let e=()=>void 0!==window.O365Shell;if(e()){c&&c(null);return}let f=document.head.querySelector("#"+b);if(f&&f.src===a)try{(0,j.e)(e,300,3e4).then(()=>{c(null)})}catch(a){d(null,"Unable to load O365Shell")}else{f&&f.src!==a&&o.removeHeadScriptElement(b);let e=document.createElement("script");e.id=b,e.src=a,c&&e.addEventListener("load",a=>{c(a)}),d&&e.addEventListener("error",a=>{d(a)}),document.head.appendChild(e)}}constructor(a,b){this._cachePrefix="odSuiteNav",this._cacheDataKey="Data",this._cacheThemeDataKey="ThemeData",this._cacheDateKey="CacheDate",this._cacheVersionKey="CacheVersion",this._cacheSessionKey="CachedThisSession",this._cacheVersion=6,this._cacheExpire=24,this._cacheRenew=12,this._cache=new h.a(this._cachePrefix,i.a.local),this._dataSourceBasic=b.dataSource,this._pageContext=b.pageContext,this._engagementEvent=a.engagementEvent,this._qosEvents=a.qosEvents,this._capabilities=this._dataSourceBasic.getCapabilities();const{require:c=o.require}=b;this._stopCachingGuestModeNavDataKSActivated=n.a.isActivated("2b530fb4-c76f-442e-a49e-e0259135ce2f"),this._require=c}}function p(a){let b=a.error;if(b&&b.resultCode)return b;let c=g.a.Failure;return d.c.isCanceled(b)&&(c=g.a.ExpectedFailure,a.resultCode="Canceled"),{resultType:c,resultCode:a.resultCode||"Other",error:b,extraData:a.extraData}}let q=o}
,455:(a,b,c)=>{c.d(b,{a:()=>d});let d={GET_O365_SHELL:"SuiteNavProvider.GetO365Shell",SUITE_NAV_PROVIDER_LOAD_DATA:"SuiteNavProvider.LoadData",SUITE_NAV_LOAD:"SuiteNav.Load",SUITE_NAV_RENDER:"SuiteNav.Render",SUITE_NAV_POSTRENDER:"SuiteNav.PostRender",REFRESH_CACHE_FOR_SHELL_DATA_CHANGED:"SuiteNav.RefreshCacheForShellDataChanged",REFRESH_CACHE_AFTER_INVALID_SHELL_DATA:"SuiteNav.RefreshCacheAfterInvalidShellData"}}
,1145:(a,b,c)=>{c.d(b,{a:()=>i,b:()=>j,c:()=>k,d:()=>l});var d=c(232),e=c(214),f=c(1),g=c(200);let h={ODB:f.a.isActivated("904afe8e-3cce-4ab4-ac2f-97b60197cf59","11/9/2021","Disable check for webTemplate mySite as qualification for isOdb"),ECS:108854},i=window._spPageContextInfo&&(window._spPageContextInfo.listBaseTemplate===d.a.mySiteDocumentLibrary||!e.b.isFeatureEnabled(h)&&Number(window._spPageContextInfo.webTemplate)===g.b.mySite),j=!!window.FilesConfig,k=i||j,l=!i&&!j}
,1966:(a,b,c)=>{c.d(b,{a:()=>d});let d={neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8"}}
,1965:(a,b,c)=>{c.d(b,{a:()=>q,b:()=>u,c:()=>w,d:()=>x,e:()=>y});var d,e,f=c(25),g=c(214);c(8);var h=c(339),i=c(1145),j=c(1966),k=c(1);let l="#3d3e66",m="#e9eaf6",n="#616161",o="#ebebeb",p={black:"#242424",neutralDark:"#424242",neutralPrimary:n,neutralPrimaryAlt:n,neutralSecondary:"#8a8a8a",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#d1d1d1",neutralQuaternary:o,neutralQuaternaryAlt:o,neutralLight:"#f0f0f0",neutralLighter:"#f5f5f5",neutralLighterAlt:"#fafafa",white:"#fff",themeDarker:"#323348",themeDark:l,themeDarkAlt:l,themePrimary:"#5b5fc7",themeSecondary:"#9092c1",themeTertiary:"#a5a7cf",themeLight:"#385dc2",themeLighter:m,themeLighterAlt:m,accent:"#137ad1"};function q(a,b,c){var d;let e;return k.a.isActivated("0d6cef16-2b13-4ef6-94c6-60e57e73d2a3")?(d=a,b&&(g.b.initSPExpFeatures(b.ExpFeatures),g.b.initSPEcsClientFeatures(b.ECSClientFeatures)),f.d.evaluateCanOverride(),i.c||(d=t({palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}},d)),(e=d.palette)&&(e.black||e.neutralPrimary||e.white||e.neutralQuaternary)&&(!e.black||!e.white||!e.neutralPrimary||!e.neutralQuaternary||0!==e.black.indexOf("#000")||0!==e.white.toLowerCase().indexOf("#fff")||0!==e.neutralPrimary.indexOf("#333")||0!==e.neutralQuaternary.toLowerCase().indexOf("#d0d0d0"))||(d.palette={...d.palette,...j.a}),d):(b&&(g.b.initSPExpFeatures(b.ExpFeatures),g.b.initSPEcsClientFeatures(b.ECSClientFeatures)),f.d.evaluateCanOverride(),function(a,b){switch(a){case 0:return r(b);case 1:return r(t({palette:p},b));default:return r(t(s,b))}}(i.c?0:(!c||!b?.themedCssFolderUrl)&&function(a){if(k.a.isActivated("a7baa93c-d9fa-4e23-aa22-5f51ad9fab63")||!a)return!1;{let b=a.featureInfo?.VivaBackendFeature;return b?b.Enabled:a.isCurrentSiteAVivaBackendSite}}(b)?1:2,a))}function r(a){let b,c;return c=!(b=a.palette).black&&!b.neutralPrimary&&!b.white&&!b.neutralQuaternary||b.black&&b.white&&b.neutralPrimary&&b.neutralQuaternary&&0===b.black.indexOf("#000")&&0===b.white.toLowerCase().indexOf("#fff")&&0===b.neutralPrimary.indexOf("#333")&&0===b.neutralQuaternary.toLowerCase().indexOf("#d0d0d0"),(!b||c)&&(a.palette={...a.palette,...j.a}),a}let s={palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}};function t(a,b){return{...a,...b,effects:{...a.effects,...b.effects},fonts:{...a.fonts,...b.fonts},palette:{...a.palette,...b.palette}}}function u(){let a=[],b=h.a.getSettings(["theme"]).theme;return b&&(a.push(v(b.palette,"--ms-palette")),a.push(v(b.semanticColors,"--ms-semanticColors")),a.push(v(b.fonts,"--ms-fonts")),a.push(v(b.effects,"--ms-effects"))),a.join(" ")}function v(a,b){let c=[];for(let d in a){let e=a[d];"object"==typeof e?c.push(v(e,`${b}-${d}`)):0!==d.indexOf("MozOsx")&&0!==d.indexOf("Webkit")&&0!==d.indexOf("fontFamily")&&c.push(`${b}-${d}: ${e};`)}return c.join(" ")}function w(a){let b=k.a.isActivated("17d606aa-a12a-4d3e-b988-db14e6dc370f")?window._spPageContextInfo:a??window._spPageContextInfo;return b&&(g.b.initSPExpFeatures(b.ExpFeatures),g.b.initSPEcsClientFeatures(b.ECSClientFeatures)),g.b.isFeatureEnabled({ODB:61259})}function x(a){let b=a??window._spPageContextInfo;return b&&(g.b.initSPExpFeatures(b.ExpFeatures),g.b.initSPEcsClientFeatures(b.ECSClientFeatures)),g.b.isFeatureEnabled({ODB:61852})}function y(a){if(a){let b=/^([0-9]+)\.([0-9]+)(?:\.([0-9]+)(?:\.([0-9]+))?)?$/g.exec(a);if(b)return 2===parseInt(b[1],10)}return!1}(d=e||(e={}))[d.noDefault=0]="noDefault",d[d.vivaHomeDefault=1]="vivaHomeDefault",d[d.spDefault=2]="spDefault"}
,1384:(a,b,c)=>{c.d(b,{a:()=>j,b:()=>m,c:()=>l,d:()=>k,e:()=>i});var d=c(27),e=c(200),f=c(1385),g=c(25),h=c(213);function i(a,b,c){let e=0;return new d.c(function(d,f){let g=setInterval(()=>{if(e*b<=c)e++,a()&&(clearInterval(g),d());else throw clearInterval(g),"Timed out waiting for checker "+a},b)})}function j(a){if(!a.featureInfo)return Number(a.webTemplate)===e.b.sitePagePublishing;{let b=new f.a(a.featureInfo);if(!b)return!1;{let a=b.get("SitePagePublishing");return!!a&&a.enabled}}}function k(a){if(a.featureInfo){let b=new f.a(a.featureInfo);if(b){let a=b.get("KnowledgeSite");return!!a&&a.enabled}}return!1}function l(a){return g.d.isFeatureEnabled({ODB:60334})?a.isCurrentSiteAHomeSite:!!(a.companyPortalReference&&a.companyPortalReference.SiteId&&a.companyPortalReference.WebId&&a.siteId&&a.siteId.indexOf(a.companyPortalReference.SiteId)>=0&&a.webId&&a.webId.indexOf(a.companyPortalReference.WebId)>=0)}function m(a,b){return b?.length>=0?a?.homeSiteNavConfigs?.[h.a.normalizeLower(b)]?.IsEnabled||!1:a?.homeSiteNavConfigs?.[h.a.normalizeLower(a.siteId)]?.IsEnabled||!1}}
,697:(a,b,c)=>{c.d(b,{a:()=>i});var d=c(408),e=c(190),f=c(154);let g="GetSchemaException";function h(a,b,c){let d={resultType:a};return b&&(d.resultCode=b),c&&(d.error=c),d}function i(a,b,c,i,j){let k,l=new a(b);try{k=c()}catch(a){throw l.end(h(f.a.Failure,"PromiseCreationFailed",(0,e.c)(a.toString()))),a}return k.then(a=>{let b;if(i)try{b=i(a)}catch(a){b=h(f.a.Failure,g,(0,e.c)(a.toString()))}else b=h(f.a.Success);l.end(b)},a=>{let b;if(j)try{b=j(a)}catch(a){b=h(f.a.Failure,g,(0,e.c)(a.toString()))}else b=a?h(a instanceof Error&&"Canceled"===a.name?f.a.ExpectedFailure:f.a.Failure,void 0,(0,e.c)((0,d.a)(a),"unsafe")):h(f.a.Failure);l.end(b)}),k}}
,1211:(a,b,c)=>{let d,e;c.r(b),c.d(b,{clearCache:()=>aB,default:()=>az,isProvisioning:()=>aC,resourceKey:()=>aA});var f,g,h=c(130),i=c(100),j=c(65),k=c(50),l=c(8),m=c(1964),n=c(117),o=c(38);let p=(0,n.a)({eventName:"SuiteNavError,",shortEventName:"SuiteNavError"},{message:o.a.String,stack:o.a.String,type:o.a.String});var q=c(200),r=c(658),s=c(92),t=c(25),u=c(1),v=c(27);class w{static clone(a){return w.fromRgba(a.R,a.G,a.B,a.A)}static equals(a,b){let c=!a,d=!b;return c||d?c&&d:a.R===b.R&&a.G===b.G&&a.B===b.B&&a.A===b.A}static fromRgba(a,b,c,d){let e=new w;return e.R=Math.round(a),e.G=Math.round(b),e.B=Math.round(c),e.A=null!=d?Math.round(d):w.maxComponent,e}static fromRgbaString(a){let b=new w;if(/^rgb.+/.test(a)){let c=a.match(/[\d.]+/g);b=w.fromRgba(Number(c[0]),Number(c[1]),Number(c[2]),4===c.length?Number(c[3])*w.maxComponent:null)}return b}static fromHtmlColor(a){function b(a,b,c){return parseInt(a.charAt(b)+a.charAt(c),16)}let c=new w;if("string"==typeof a&&"#"===a.charAt(0))switch(a.length){case 9:c.A=b(a,1,2),c.R=b(a,3,4),c.G=b(a,5,6),c.B=b(a,7,8);break;case 7:c.R=b(a,1,2),c.G=b(a,3,4),c.B=b(a,5,6);break;case 4:c.R=b(a,1,1),c.G=b(a,2,2),c.B=b(a,3,3)}else/^rgb.+/.test(a)&&(c=w.fromRgbaString(a));return c}static toHtmlString(a,b){function c(a){let b=Number(a);if(!(b>=0&&b<=w.maxComponent))throw Error("Argument must be a Number in [0, 255]");let c=b.toString(16);return b<16&&(c="0"+c),c}return a.A<w.maxComponent&&!b?"rgba("+a.R.toString(10)+", "+a.G.toString(10)+", "+a.B.toString(10)+", "+(a.A/w.maxComponent).toFixed(2)+")":"#"+(b?c(a.A):"")+c(a.R)+c(a.G)+c(a.B)}constructor(){this.R=0,this.G=0,this.B=0,this.A=w.maxComponent}}w.maxComponent=255;var x=c(36);let y="Data",z="CacheToken",A="CacheVersion",B="CacheExpires",C=/^#[0-9A-Fa-f]{6}$/i,D=/^(#[0-9A-Fa-f]{6});web#\d+$/i,E=/^\/.+_catalogs\/theme\/Themed\/.+$/i;class F{static clearThemeCache(){let a=F.getThemeDataStore();a.remove(y),a.remove(z),a.remove(A),a.remove(B)}static getCachedTheme(a,b){let c,d=F.getThemeDataStore();try{let e=d.getValue(B);a===d.getValue(z)&&"1.7"===d.getValue(A)&&(!e||Date.now()<e)&&(c=d.getValue(y),b&&F._isDirtyCache(a,c)&&(F.clearThemeCache(),c=void 0))}catch{}return c}static updateThemeCache(a,b){let c=F.getThemeDataStore();if(c.setValue(y,a),c.setValue(z,b||a.cacheToken),c.setValue(A,"1.7"),a?.cacheMaxAge){let b=1e3*a.cacheMaxAge;c.setValue(B,Date.now()+b)}else c.remove(B)}static getHeaderThemeCache(a,b){let c=F._getHeaderThemeDataStore().getValue(y);if(c){let d=c.find(b=>b.siteAbsoluteUrl===a);if(d&&d.themedCssFolderUrl===b)return d.themeData}}static updateHeaderThemeCache(a,b,c){let d=F._getHeaderThemeDataStore(),e=d.getValue(y)||[],f={siteAbsoluteUrl:a,themeData:b,themedCssFolderUrl:c};e.length||(e.unshift(f),d.setValue(y,[f]));let g=e.findIndex(b=>b.siteAbsoluteUrl===a);-1!==g&&e.splice(g,1),e.unshift(f),e.length>20&&e.pop(),d.setValue(y,e)}static getThemeDataStore(){return new i.a("odTheme",j.a.local)}static _getHeaderThemeDataStore(){return new i.a("odHeaderTheme",j.a.local)}static _isDirtyCache(a,b){let c=!1;try{if(a&&b&&b.cacheToken){let d=F._getRefinedCacheTokenFromCacheToken(a)||"",e=F._getRefinedCacheTokenFromThemeData(b)||"";d&&e?c=d.toLowerCase()!==e.toLowerCase():(x.a.logData({name:"ThemeCache.UnknownPattern",extraData:{cacheToken:a,cacheTokenInTheme:b.cacheToken}}),c=!1)}}catch{}return c&&x.a.logData({name:"ThemeCache.DirtyCache",extraData:{cacheToken:a,cacheTokenInTheme:b.cacheToken}}),c}static _getRefinedCacheTokenFromThemeData(a){if(a&&a.cacheToken){let b=a.cacheToken.split(":");if(4===b.length)return b[1];let c=a.cacheToken.match(C);if(c)return c[0]}}static _getRefinedCacheTokenFromCacheToken(a){if(a){let b=a.match(E);if(b)return b[0];let c=a.match(D);if(c)return c[1]}}}var G=c(12),H=c(697);class I{static getBackgroundUrl(a){return a?I._makeCssUrl(a.backgroundImageUri):"none"}static _makeCssUrl(a){let b="none";return a&&(b='url("'+I._escapeQuotesAndParentheses(a)+'")'),b}static _escapeQuotesAndParentheses(a){let b={"'":"%27",'"':"%22","(":"%28",")":"%29"},c=null;return null!=a&&(c=a.replace(/(['"\(\)])/gm,function(a,c){return b[c]})),c}loadThemeTokenMap(a,b){return this.loadThemeData(a,b).then(function(a){let b;if(a&&a.palette){b={};let c=a.palette;for(let a in c){let d=c[a];b[a]=d?w.toHtmlString(d):null}b.backgroundImageUri=I._makeCssUrl(a.backgroundImageUri)}return b},a=>null)}loadThemeData(a,b){if(!b&&this._dataPromise)return this._dataPromise;let c=!u.a.isActivated("c315e78f-4479-425b-bf5c-91c954c3f823"),d=this,e=null,f=G.b.Failure;return this._dataPromise=(0,H.a)(G.a,{name:"ThemeProvider.LoadData"},()=>new v.c(function(g,h){let i=null;b||(i=F.getCachedTheme(a,c)),i?g(i):d._loadData(b).done(function(b){b?(b.cacheToken&&F.updateThemeCache(b,a),g(b)):(e="NoData",h&&h("No model returned"))},function(a){v.c.isCanceled(a)?(e="Canceled",f=G.b.ExpectedFailure):e="ServerLoadFailure",h&&h(a)})}),null,function(a){v.c.isCanceled(a)&&(f=G.b.ExpectedFailure,e="Canceled");let b=a;return a&&(b=JSON.stringify({name:a.name||void 0,message:a.message&&a.message.value||a.message||void 0,correlationId:a.correlationId||void 0})),{resultType:f,resultCode:e||"Other",error:b}}),this._dataPromise}constructor(a){this._loadData=a}}var J=c(1965);class K{loadThemeSlotsMap(a){let b=this._getThemeCacheToken();return b?this._themeProvider.loadThemeTokenMap(b,a):v.c.resolve()}loadFullFormattedThemeData(a){return this.loadFullThemeData(a).then(a=>this._handleIThemeDataToFullFormattedThemeData(a))}loadFullThemeData(a){let b=this._getThemeCacheToken();return b?this._themeProvider.loadThemeData(b,a):v.c.resolve(void 0)}loadThemeDataWithCacheToken(a){return this._forceLoadServerTheme().then(a=>this._handleIThemeDataToFullFormattedThemeData(a))}loadGeneratedTheme(){return this._themeDataSource||(this._themeDataSource=this._getThemeDataSource()),this._themeDataSource.then(a=>a?a.loadGeneratedTheme().then(a=>this._handleIThemeDataToFullFormattedThemeData(a)):v.c.resolve())}getThemeCacheToken(){return this._getThemeCacheToken()}_getThemeCacheToken(){let a,b=this._pageContext;if(b){let c=Number(b.webTemplate),d=c===q.a.teamSite||c===q.a.group?b.groupColor:void 0,e=d?d+";web#"+b.webTemplate:null;a=b.themedCssFolderUrl||e||void 0}return a}_loadTheme(a){return this._getThemeCacheToken()?(this._themeDataSource||(this._themeDataSource=this._getThemeDataSource()),this._themeDataSource.then(b=>b?b.loadTheme(a):v.c.resolve())):v.c.resolve()}_forceLoadServerTheme(){return this._themeDataSource||(this._themeDataSource=this._getThemeDataSource()),this._themeDataSource.then(a=>a?a.loadServerTheme():v.c.resolve())}_handleIThemeDataToFullFormattedThemeData(a){let b,c,d,e,f,g,h;if(!a)return;let i={},j=a.palette;for(let a in j){let b=j[a];b&&(i[a]=w.toHtmlString(b))}if(a.backgroundImageUri&&(i.backgroundImageUri=I.getBackgroundUrl(a)),(0,J.d)(this._pageContext)&&(0,J.e)(a.themeSchemaVersion)){let f={};for(let b in a.otherMode?.palette){let c=a.otherMode.palette[b];c&&(f[b]=w.toHtmlString(c))}b=Object.keys(f).length>0?{...a.otherMode,palette:f}:void 0;let g=[],h=[];for(let b of a.secondaryColors?.dark??[]){let a=this._handleColorPair(b);g.push(a)}for(let b of a.secondaryColors?.light??[]){let a=this._handleColorPair(b);h.push(a)}c={dark:g,light:h},e=a.displayMode,d=a.themeSchemaVersion}if((0,J.c)(this._pageContext)&&a.fontPackage&&a.fontPackage.fontFaces&&a.fontPackage.fontSlots){f=a.fontPackage.fontFaces,g={},h=a.fontPackage.fontPackageSource;let b=a=>{let b;if(b=this._isEnquoteKillswitchActivated?{fontFamily:a.fontFamily&&'"'+a.fontFamily.replace(/"/g,'\\"')+'"'}:{fontFamily:a.fontFamily&&this._enquoteIfNeeded(a.fontFamily)},a.fontVariationSettings){let c=Object.keys(a.fontVariationSettings),d="";for(let e of c){let c=a.fontVariationSettings[e];switch(e){case"wght":b.fontWeight=c;break;case"wdth":b.fontStretch=c;break;case"slnt":b.fontStyle=`oblique ${c}deg`;break;case"ital":b.fontStyle=c?"italic":"normal";break;case"opsz":b.fontOpticalSizing=c;break;default:d+=d?", ":"",this._isEnquoteKillswitchActivated?d+=`"${e}" ${c}`:d+=`${this._enquoteIfNeeded(e)} ${c}`}}d&&(b.fontVariationSettings=d)}return t.d.isFeatureEnabled({ODB:60044})&&t.d.isFeatureEnabled({ODB:62505})&&(b.fontFace=a.fontFace,b.fontVariationSettings=a.fontVariationSettings),b};for(let[c,d]of Object.entries(a.fontPackage.fontSlots))u.a.isActivated("661c8da2-e6df-4c44-95fb-d32ccf03998f","12/12/2023")?g[c]={fontFamily:d?.fontFamily}:g[c]=b(d)}let k={palette:i,isInverted:a.isInverted,fontPackageSource:h,fontFaces:f,fontSlots:g,...b&&{otherMode:b},...c&&{secondaryColors:c},...e&&{displayMode:e??"light"},...d&&{themeSchemaVersion:d}};return(0,J.a)(k,this._pageContext)}_enquoteIfNeeded(a){return a.startsWith('"')&&a.endsWith('"')?a:`"${a.replace(/"/g,'\\"')}"`}_handleColorPair(a){try{return{themePrimary:w.toHtmlString(a.themePrimary),backgroundColor:a.backgroundColor?w.toHtmlString(a.backgroundColor):void 0}}catch(a){return{themePrimary:""}}}constructor(a){this._isEnquoteKillswitchActivated=u.a.isActivated("b39f1385-ab28-4f24-b610-ec20f5dfac7b"),this._pageContext=a.pageContext?a.pageContext:window._spPageContextInfo,this._getThemeDataSource=a.getThemeDataSource,this._themeProvider=new I(this._loadTheme.bind(this))}}var L=c(1212),M=c(689);let N=[.537,.349,.216,.184,.145,.082,.043,.027],O=[.537,.45,.349,.216,.184,.145,.082,.043],P=[.88,.77,.66,.55,.44,.33,.22,.11],Q=[.11,.22,.33,.44,.55,.66,.77,.88],R=[.96,.84,.7,.4,.12],S=[.1,.24,.44];function T(a,b){return{h:a.h,s:a.s,v:a.v-a.v*b}}function U(a,b){return{h:a.h,s:a.s-a.s*b,v:a.v+(100-a.v)*b}}(f=g||(g={}))[f.Unshaded=0]="Unshaded",f[f.Shade1=1]="Shade1",f[f.Shade2=2]="Shade2",f[f.Shade3=3]="Shade3",f[f.Shade4=4]="Shade4",f[f.Shade5=5]="Shade5",f[f.Shade6=6]="Shade6",f[f.Shade7=7]="Shade7",f[f.Shade8=8]="Shade8";class V{static generateFabricColors(a,b=!1){let c={themeDarker:g.Shade8,themeDark:g.Shade7,themeDarkAlt:g.Shade6,themeLight:g.Shade3,themeLighter:g.Shade2,themeLighterAlt:g.Shade1,themePrimary:g.Unshaded,themeAccent:g.Unshaded,themeSecondary:g.Shade5,themeTertiary:g.Shade4},d=V._getDefaultThemeTokenMap(),e=w.fromRgba(a.R,a.G,a.B);for(let a in c){let f=c[a];d[a]=function(a,b,c){if(!a||0===b||!("number"==typeof b&&b>=0&&b<=8))return a;let d=U,e=T;c&&(d=T,e=U);let f=function(a){let b=NaN,{R:c,G:d,B:e}=a,f=Math.max(c,d,e),g=f-Math.min(c,d,e);return 0===g?b=0:c===f?b=(d-e)/g%6:d===f?b=(e-c)/g+2:e===f&&(b=(c-d)/g+4),(b=Math.round(60*b))<0&&(b+=360),{h:b,s:Math.round((0===f?0:g/f)*100),v:Math.round(f/255*100)}}(a),g=function(a){let{s:b,v:c}=a,{h:d}=a,e=(2-(b/=100))*(c/=100),f=b*c;return f/=e<=1?e:2-e,{h:d,s:100*(f=f||0),l:100*(e/=2)}}(f),h=b-1;return function(a){let{s:b,v:c}=a,{h:d}=a,e=[],f=(c/=100)*(b/=100),g=d/60,h=f*(1-Math.abs(g%2-1)),i=c-f;switch(Math.floor(g)){case 0:e=[f,h,0];break;case 1:e=[h,f,0];break;case 2:e=[0,f,h];break;case 3:e=[0,h,f];break;case 4:e=[h,0,f];break;case 5:e=[f,0,h]}return w.fromRgba(Math.round(255*(e[0]+i)),Math.round(255*(e[1]+i)),Math.round(255*(e[2]+i)))}(f=255===a.R&&255===a.G&&255===a.B?T(f,N[h]):0===a.R&&0===a.G&&0===a.B?U(f,O[h]):g.l/100>.8?e(f,Q[h]):g.l/100<.2?d(f,P[h]):h<R.length?d(f,R[h]):e(f,S[h-R.length]))}(e,f,b)}let f=d.themeAccent;if(d.themeAccentTranslucent10=f?w.fromRgba(f.R,f.G,f.B,.1*w.maxComponent):null,b){let a="#4f4f4f",b="#484848",c={black:"#fff",blackTranslucent40:"#66ffffff",neutralDark:"#f4f4f4",neutralPrimary:"#fff",neutralPrimaryTranslucent50:"#7fffffff",neutralPrimaryAlt:"#dadada",neutralSecondary:"#d0d0d0",neutralTertiary:"#c8c8c8",neutralTertiaryAlt:"#6d6d6d",neutralQuaternary:a,neutralQuaternaryAlt:b,cmdbarSelected:a,cmdbarSelectedHover:b,neutralLight:"#3f3f3f",neutralLighter:"#313131",neutralLighterAlt:"#282828",white:"#1f1f1f",whiteTranslucent40:"#661f1f1f",error:"#f00",errorBackground:"#7e3333"};for(let a in c)c.hasOwnProperty(a)&&(d[a]=w.fromHtmlColor(c[a]))}return d}static _getDefaultThemeTokenMap(){return{backgroundOverlay:null,themeDarker:null,themeDark:null,themeDarkAlt:null,themePrimary:null,themeSecondary:null,themeTertiary:null,themeLight:null,themeLighter:null,themeLighterAlt:null,black:null,cmdbarSelected:null,cmdbarSelectedHover:null,neutralDark:null,neutralPrimary:null,neutralPrimaryAlt:null,neutralPrimaryTranslucent50:null,neutralSecondary:null,neutralSecondaryAlt:null,neutralTertiary:null,neutralTertiaryAlt:null,neutralQuaternary:null,neutralQuaternaryAlt:null,neutralLight:null,neutralLighter:null,neutralLighterAlt:null,white:null,blackTranslucent40:null,whiteTranslucent40:null,yellow:null,yellowLight:null,orange:null,orangeLight:null,redDark:null,red:null,magentaDark:null,magenta:null,magentaLight:null,purpleDark:null,purple:null,purpleLight:null,blueDark:null,blueMid:null,blue:null,blueLight:null,tealDark:null,teal:null,tealLight:null,greenDark:null,green:null,greenLight:null,error:null,errorBackground:null,success:null,successBackground:null,alert:null,alertBackground:null,infoBackground:null,info:null,orangeLighter:null}}}var W=c(548);let X={ODB:60044},Y={ODB:62505};class Z{static makeWebThemeRestUrl(a,b,c){let d=a;d&&"/"===d[d.length-1]&&(d=d.substring(0,d.length-1)),d=W.a.escapeUrlForCallback(d);let e=W.a.escapeUrlForCallback(d)+"/_api/SP.Web.GetContextWebThemeData?noImages=true&lcid="+W.a.encodeURIComponent(b);return c&&(e+="&ThemeOverride="+W.a.encodeURIComponent(c)),e}static processWebThemeRestResponse(a,b){let c,d=JSON.parse(a);return d&&d.d&&d.d.GetContextWebThemeData&&(c=JSON.parse(d.d.GetContextWebThemeData)),Z.processRawThemeData(c,b)}static processRawThemeData(a,b){if(a){let c,d,e,f,g,h=Z.coerceToColor,i=Z.SetColorIfMissing,j={},k=a.Palette?a.Palette.Colors:{};j=Z.convertColorsToRgba(k);let l=V.generateFabricColors(j.ContentAccent1,a.IsInverted),m=h(j.PageBackground)||h(a.IsInverted?"#1b1a19":"#ffffff"),n=h(j.BackgroundOverlay)||null,o=Math.round(.4*w.maxComponent);for(let a in l)i(j,a,l[a]);if(i(j,"white",m),i(j,"primaryBackground",w.clone(m)),i(j,"primaryText",l.primaryText||h("#333")),i(j,"whiteTranslucent40",m&&w.fromRgba(m.R,m.G,m.B,o)),i(j,"backgroundOverlay",n),i(j,"suiteBarBackground",h(j.SuiteBarBackground)||null),i(j,"suiteBarText",h(j.SuiteBarText)||null),i(j,"suiteBarDisabledText",h(j.SuiteBarDisabledText)||null),i(j,"topBarBackground",h(j.TopBarBackground)||null),i(j,"topBarText",h(j.TopBarText)||null),i(j,"topBarHoverText",h(j.TopBarHoverText)||null),i(j,"dialogBorder",h(j.DialogBorder)||null),b&&Z.isThemeV2Schema(a.ThemeSchemaVersion)&&(i(j,"backgroundColor",h("#ffffff")),a.OtherMode&&(c=Z.processRawOtherModeColors(a.OtherMode)),a.SecondaryColors&&(d=Z.processRawSecondaryColors(a.SecondaryColors)),e=a.ThemeSchemaVersion,f=a.DisplayMode),a.FontPackage){let b=a.FontPackage.FontFaces&&a.FontPackage.FontFaces.map(a=>({fontFamily:a.FontFamily,path:a.Path,remappedPaths:a.RemappedPaths})),c={};if(a.FontPackage.FontSlots)for(let b of Object.keys(a.FontPackage.FontSlots)){let d=a.FontPackage.FontSlots[b];d&&(c[b]={fontFamily:d.FontFamily,fontVariationSettings:d.FontVariationSettings,...t.d.isFeatureEnabled(X)&&t.d.isFeatureEnabled(Y)?{fontFace:d.FontFace}:{}})}g={fontFaces:b,fontSlots:c,fontPackageSource:a.FontPackage.Source}}return{backgroundImageUri:a.BackgroundImageUri,cacheToken:a.ThemeCacheToken,cacheMaxAge:a.ThemeCacheMaxAge,isDefault:a.IsDefault,isInverted:a.IsInverted,palette:j,version:a.Version,fontPackage:g,...e&&{themeSchemaVersion:e},...f&&{displayMode:f},...c&&{otherMode:c},...d&&{secondaryColors:d}}}return{backgroundImageUri:"",cacheToken:"",cacheMaxAge:void 0,isDefault:!0,isInverted:!1,palette:{},version:""}}static convertColorsToRgba(a){let b={};for(let c in a)if(a.hasOwnProperty(c)){let d=Z.coerceToColor(a[c]);d&&(b[c]=d)}return b}static processRawOtherModeColors(a){let b=a.palette??{};return Object.keys(b).length>0&&Z.SetColorIfMissing(a,"backgroundColor",Z.coerceToColor("#ffffff")),{palette:Z.convertColorsToRgba(b),isInverted:a.isInverted,displayMode:a.displayMode}}static processRawSecondaryColors(a){return{light:Z.processColorPair(a.light),dark:Z.processColorPair(a.dark)}}static processColorPair(a){return a?a.map(a=>(Z.SetColorIfMissing(a,"backgroundColor",Z.coerceToColor("#ffffff")),{themePrimary:Z.coerceToColor(a.themePrimary),backgroundColor:Z.coerceToColor(a.backgroundColor),variantType:3*("3"===a.variantType)})):[]}static isThemeV2Schema(a){if(a){let b=/^([0-9]+)\.([0-9]+)(?:\.([0-9]+)(?:\.([0-9]+))?)?$/g.exec(a);if(b)return 2===parseInt(b[1],10)}return!1}static coerceToColor(a){let b;return a?"string"==typeof a||a instanceof String?b=w.fromHtmlColor(String(a)):"DefaultColor"in a?b=Z.coerceToColor(a.DefaultColor):"R"in a&&"G"in a&&"B"in a&&(b=w.fromRgba(a.R,a.G,a.B,a.A)):b=null,b}static SetColorIfMissing(a,b,c){a[b]||(a[b]=c)}}var $=c(1145);let _=$.c?"#0078d4":"#03787c";class aa{getCacheToken(){let a="",b=this._pageContext;if(b){let c=Number(b.webTemplate),d=c!==q.b.mySite&&c!==q.b.mySiteHost?b.groupColor:_;a=b.themedCssFolderUrl||d}return a}loadTheme(a){return!a&&this._dataPromise?this._dataPromise:this.getCacheToken()?(this._dataPromise=this._pageContext.themedCssFolderUrl?this.loadServerTheme():this.loadGeneratedTheme(),this._dataPromise):this._dataPromise=v.c.resolve()}loadGeneratedTheme(){let a=this._pageContext.groupColor||_,b=w.fromHtmlColor(a);if(!b)return v.c.resolve();{let c={backgroundImageUri:void 0,cacheToken:a,cacheMaxAge:void 0,isDefault:!1,isInverted:!1,palette:V.generateFabricColors(b),version:"1"};return v.c.resolve(c)}}loadServerTheme(){let a=(0,J.d)(this._pageContext),b=(0,L.b)(this._pageContext),c=this._pageContext.currentUICultureName,d=this._pageContext.themedCssFolderUrl,e=this.getCacheToken()===d,f=Z.makeWebThemeRestUrl(b,c,e&&d||void 0),g=b=>(this._data=Z.processWebThemeRestResponse(b,a),this._data),h=this._dataRequestor.getData({url:f,parseResponse:g,qosName:"WebThemeDataSource.LoadData",method:"GET"});return h.done(void 0,()=>{this._dataPromise=v.c.resolve()}),h}needsRequestDigest(a){return!1}constructor(a){this._pageContext=a,this._dataRequestor=new M.a({qosName:"WebThemeDataSource"},{pageContext:a})}}function ab(a){var b;let c,f,g=a||window._spPageContextInfo;return b={webThemeProvider:()=>new K({pageContext:g,getThemeDataSource:()=>v.c.resolve(new aa(g))})},d&&e===b||((f=g||window._spPageContextInfo)&&(c=b.webThemeProvider(f)),d=c,e=b),d}var ac=c(307),ad=c(1134),ae=c(572),af=c(233),ag=c(1970);let ah={ODB:556,ODC:!1,Fallback:!1},ai={ODB:1302,ODC:!1,Fallback:!1},aj=u.a.isActivated("54d52105-eb9a-472b-98c2-17bc1192a994"),ak=u.a.isActivated("9056088c-2632-4fce-9d66-8fd7c79af4b8"),al=!u.a.isActivated("c3f12d1f-4f42-4a72-9f99-f0bc79a94244","06/9/2025","Always add feedback button for videohub.aspx");class am extends ad.a{clearCachedPromise(){this._modelPromise=void 0}loadData(a){return this._loadModel(a).then(a=>a.data)}getO365Shell(){if(this._isSuiteNavBootstrapperLoadingFlowEnabled)return super.getO365Shell();{if(!this._capabilities.supportsRealSuiteNav)throw Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");let a=new h.b,b=new G.a({name:"SuiteNavProvider.GetO365Shell"});return this._getSuiteNavShell(a),a.getPromise().then(()=>{b.end({resultType:G.b.Success})},a=>{b.end((0,ad.c)({error:a}))}),a.getPromise()}}getMailUrl(){return this._loadModel().then(a=>{let b=a&&a.data&&a.data.WorkloadLinks;if(b){for(let a of b)if(a&&a.Id===r.a.MAIL)return a.Url}})}updateWorkloadSettingsLinks(a){let b;return this.getO365Shell().then(c=>(b=c)&&b.Settings?this.loadData(a):void 0).then(a=>{a&&a.CurrentWorkloadSettingsSubLinks&&a.CurrentWorkloadSettingsSubLinks.length>0&&b.Settings.SetWorkloadSettingsLinks(a.CurrentWorkloadSettingsSubLinks)}).catch(a=>{x.a.logData({name:"SuiteNavProvider.UpdateWorkloadSettingsLinksError"})})}trySetDataAfterInitialRender(a,b){let c=new G.a({name:"SuiteNavProvider.SetDataCalled"}),d=this._dataSource.getSuiteNavContext();if(d&&d.isConsumer)return a.NFD&&(d.helpNamespace&&a.NFD.UpdateHelpNamespace(d.helpNamespace),this._addFeedbackButton(a)),d.actionsMap&&a.Navigation.OnLinkClick(a=>{let b=d.actionsMap[a.Id];b&&(a.Cancel=!b({...a}))}),v.c.wrap(!0);let{actionContext:e,bundleLoader:f}=b;return this.loadData().then(b=>{if(!b||!a)return!1;let d=this._isStreamAspx(),g=this._isVideoEditorAspx(),h=this._isVideoHubAspx(),i=(d||g||h||this._isFeedbackButtonEnabled())&&!!a.NFD,j=i&&(d||g||h||this._shouldAddFeedbackButton(a));if(this._pageContext){let{cloudType:a,env2:b}=this._pageContext;((0,ae.i)(b)||(0,ae.d)(b)||"gcc"===a)&&(j=i=!1)}if(j){let a=JSON.parse(b.ClientData);this._isFeedbackButtonEnabled()&&(this._isODb()||$.d)&&(a.EnableVNextFeedback=!0,a.OcpsOauthEnabled=!0,a.OcpsOauthEndpointUrl="https://clients.config.office.net/user/v1.0/web/policies"),a.OCVFeedbackMAXEnabled||$.d?(a.OCVFeedbackMAXEnabled=!1,b.ClientData=JSON.stringify(a)):i=j=!1}try{a.SetData(b),aj||(0,ag.b)(b,c,this._pageContext)}catch(a){return(0,H.a)(G.a,{name:"SuiteNav.RefreshCacheAfterInvalidShellData"},()=>this.loadData(!0)),!1}return b.ActionsMap&&a.Navigation.OnLinkClick(a=>{let c=b.ActionsMap[a.Id];c&&(a.Cancel=!c({...a,...e||{}}))}),a.OnHasMember("OnDataChanged",()=>{a.OnDataChanged(()=>(0,H.a)(G.a,{name:"SuiteNav.RefreshCacheForShellDataChanged"},()=>this.loadData(!0)).done())}),i&&j&&this._addFeedbackButton(a),f&&f.pageRenderingIsComplete(),!0},a=>(x.a.logData({name:"SuiteNavProvider.LoadDataError"}),!1))}_getSuiteNavShell(a,b){this._loadModel().then(c=>{!this._cssLoaded&&c.cssUrl&&(ac.a.loadStylesheet(c.cssUrl),this._dataSource.onCssLoad&&this._dataSource.onCssLoad(c),this._cssLoaded=!0),this._requestShellCore(c.jsUrl,b,an).then(b=>{a.complete(b)},b=>{this._modelPromise=void 0,(b=(0,ad.c)({error:b}))&&"LoadScriptError"===b.resultCode&&this._isDataFromCache?(x.a.logData({name:"SuiteNavProvider.O365ShellCacheFailed"}),this._clearCache(),this._getSuiteNavShell(a)):this._hasRetriedShell?a.error(b):(this._hasRetriedShell=!0,this._cssLoaded=!1,x.a.logData({name:"SuiteNavProvider.O365ShellRetry"}),this._getSuiteNavShell(a,!0))})})}_isODb(){return this._pageContext&&void 0!==this._pageContext.listBaseTemplate&&!u.a.isActivated("5488D0DA-5FA4-41EF-95EE-032C1D85ACFF")?this._pageContext.listBaseTemplate===af.a.mySiteDocumentLibrary:$.a}_loadModel(a){let b,c;if(!a&&this._modelPromise)return this._modelPromise;let d=new h.b,e=this._capabilities.supportsCaching,f=this._dataSource,g=G.b.Failure,i=(0,H.a)(G.a,{name:"SuiteNavProvider.LoadData"},()=>new v.c((c,d)=>{let h;if(!a&&e&&this._isCacheValid()&&(h=this._cache.getValue(this._cacheDataKey)),h&&h.data){let a=new G.a({name:"SuiteNavProvider.GetCachedData"});f.updateDataForCurrentPage&&(h.data=f.updateDataForCurrentPage(h.data)),e&&this._isCacheOutdated()&&f.loadData().then(a=>{this._updateCache(a)}),aj||(0,ag.b)(h.data,a,this._pageContext),this._isDataFromCache=!0,c(h)}else this._isDataFromCache=!1,f.loadData().done(a=>{let f;a?a.data?(e&&!((f=a&&a.data&&a.data.WorkloadLinks)&&f.some(a=>a&&!a.Url))&&this._updateCache(a),c(a)):(b="NoModelData",d("Model with no data returned")):(b="NoModel",d("No model returned"))},a=>{v.c.isCanceled(d)?(b="Canceled",g=G.b.ExpectedFailure):b="ServerLoadFailure",d(a)})}),null,a=>(v.c.isCanceled(a)&&(g=G.b.ExpectedFailure,b="Canceled"),{resultType:g,resultCode:b||"Other",error:a}));return(c=ab())?this._modelPromise=v.c.all({suiteNavModel:i,theme:c.loadThemeSlotsMap()}).then(a=>{let{suiteNavModel:b,theme:c}=a,d=b&&b.data,e=b&&b.hasCobranding,f=d&&d.UseSPOBehaviors,g=t.d.isFeatureEnabled(ah),h=c&&c.suiteBarBackground;return h&&d&&f&&(!e||!g)&&(d.ThemeColors=[h,c.primaryText,h,c.suiteBarText,c.suiteBarDisabledText,c.topBarBackground,c.topBarText,c.topBarHoverText,c.primaryBackground,c.themeLighterAlt,c.dialogBorder]),b}):this._modelPromise=i,this._modelPromise.then(a=>d.complete(a),a=>d.error(a)),d.getPromise()}_isFeedbackButtonEnabled(){return t.d.isFeatureEnabled({ODB:this._isODb()?60887:1246,ODC:!1,Fallback:!1})}_shouldAddFeedbackButton(a){let b=!1;if(this._isFeedbackButtonEnabled()){let a=this._dataSource.getWebTemplateType?this._dataSource.getWebTemplateType():q.b.invalid;b=a!==q.b.mySiteHost&&!$.b&&a!==q.b.tenantAdmin||/\/_layouts\/15\/Lists.aspx$/i.test(window.location.pathname)}return!b&&this._isStreamAspx()&&(b=t.d.isFeatureEnabled({ODB:1246,ODC:!1,Fallback:!1})),!u.a.isActivated("75697801-be84-49ba-8965-a7f46603d722","08/13/2025","Never add feedback button for accessdenied.aspx")&&/\/_layouts\/15\/accessdenied.aspx$/i.test(window.location.pathname)&&(b=!1),!u.a.isActivated("a1dc3b5f-8668-4cdf-afdf-57bdc0194b53","06/13/2023","Always add feedback button for videoeditor.aspx")&&!b&&/\/_layouts\/15\/videoeditor.aspx$/i.test(window.location.pathname)&&!$.b&&(b=!0),b}_isStreamAspx(){return u.a.isActivated("1da070f4-d176-43bf-a6db-6b00339b819b","02/07/2024","Check stream path from serverRequestPath")?/\/_layouts\/15\/stream.aspx$/i.test(window.location.pathname):/\/stream\.aspx/i.test(this._pageContext?.serverRequestPath??"")}_isVideoEditorAspx(){return!!(!u.a.isActivated("a1dc3b5f-8668-4cdf-afdf-57bdc0194b53","06/13/2023","Always add feedback button for videoeditor.aspx")&&/\/_layouts\/15\/videoeditor.aspx$/i.test(window.location.pathname))}_isVideoHubAspx(){return!!(al&&/\/_layouts\/15\/videohub.aspx$/i.test(window.location.pathname))}_addFeedbackButton(a){let b="GiveFeedbackButton",c="Feedback",d=()=>{a.FlexPane?.CloseFlexPaneForProvider(c),s.a.raise(document.body,"resize",void 0,!0),ak||document.getElementById(b)?.focus()},e=()=>{a.NFD&&a.NFD.OnFeedbackMetadataRequested((a,b)=>a=this._dataSource.setFeedbackMetadata(a,b)),a.FlexPane&&(a.FlexPane.OpenFlexPaneForProvider(c),s.a.raise(document.body,"resize",void 0,!0)),a.Extensibility?.UpdateButtonState(b,!0)},f=this._isMultipleFontFacesKsActivated?"FabricMDL2Icons":"FabricMDL2Icons, Fluent MDL2 Hybrid Icons";u.a.isActivated("4dcd117e-f86f-4bbe-bef1-3afc60df78f7","03/02/2022","Load Feedback icon before using it")?a.Extensibility?.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:m.a,ariaLabel:m.a,iconFontFamily:f,iconFontName:"",id:b,onShow:e,onHide:d}):a.Extensibility&&((0,l.C)("Feedback"),a.Extensibility.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:m.a,ariaLabel:m.a,iconFontFamily:f,iconFontName:"",id:b,onShow:e,onHide:d}))}_clearCache(){this._cache.remove(this._cacheDataKey),this._cache.remove(this._cacheThemeDataKey),this._cache.remove(this._cacheDateKey),this._cache.remove(this._cacheVersionKey),this._cache.remove(this._cacheSessionKey,j.a.session)}_updateCache(a,b){(this._stopCachingGuestModeNavDataKSActivated||!this._isGuestModeNavData(a.data))&&(this._cache.setValue(this._cacheDataKey,a),this._cache.setValue(this._cacheDateKey,new Date),this._cache.setValue(this._cacheVersionKey,this._cacheVersion),this._cache.setValue(this._cacheSessionKey,!0,j.a.session))}_isCacheOutdated(){let a=this._cache.getValue(this._cacheSessionKey,j.a.session),b=Date.parse(this._cache.getValue(this._cacheDateKey));return i.a.hasStorageType(j.a.session)&&!a||Date.now()-b>=60*this._cacheRenew*6e4}constructor(a,b){super({engagementEvent:x.a,qosEvents:{"SuiteNavProvider.GetO365Shell":new G.a({name:"SuiteNavProvider.GetO365Shell"})}},b),this._dataSource=b.dataSource,this._cssLoaded=!1,this._isSuiteNavBootstrapperLoadingFlowEnabled=t.d.isFeatureEnabled(ai),this._isMultipleFontFacesKsActivated=u.a.isActivated("7635e24c-97e6-4c2c-acd1-a141c2374dfa","1/08/2024","Use multiple font faces to load Feedback icon for in-place navigation scenario")}}function an(){let a=window._o365su;if(a&&a.b)for(let b of["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"])!function(a,b){let c=a[b];"function"==typeof c&&(a[b]=function(...a){try{return c.apply(this,a)}catch(a){p.logData({message:a&&a.message||"",stack:a&&a.stack||"",type:b})}})}(a.b,b)}var ao=c(785),ap=c(95),aq=c(2326),ar=c(96),as=c(1146),at=c(245);let au="Data",av="CacheDate",aw="CacheVersion",ax="CachedThisSession",ay=new i.a("odSuiteNav",j.a.local);class az{get suiteNavPlaceholder(){return this._suiteNavPlaceholder}set suiteNavPlaceholder(a){this._suiteNavPlaceholder||(this._suiteNavPlaceholder=a)}get accountSwitchCallback(){return this._dataSource.accountSwitchCallback}getCapabilities(){return this._capabilities}clearCachedPromise(){this._modelPromise=void 0,this._shellSignal=void 0}getRenderSetting(a){return this._dataSource.getRenderSetting?this._dataSource.getRenderSetting(a):null}loadData(a){return this._loadModel(a).then(a=>a.data)}getO365Shell(){if(!this._capabilities.supportsRealSuiteNav)throw Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");let a=this._shellSignal;if(!a){a=new h.b;let b=new G.a({name:"SuiteNavProvider.GetO365Shell"});this._getSuiteNavShell(a),a.getPromise().then(()=>{b.end({resultType:G.b.Success})},a=>{b.end(aE({error:a}))}),this._shellSignal=a}return a.getPromise()}getMailUrl(){return this._loadModel().then(a=>{let b=a&&a.data&&a.data.WorkloadLinks;if(b){for(let a of b)if(a&&a.Id===r.a.MAIL)return a.Url}})}_getSuiteNavShell(a,b){this._loadModel().then(c=>{!this._cssLoaded&&c.cssUrl&&(ac.a.loadStylesheet(c.cssUrl),this._dataSource.onCssLoad&&this._dataSource.onCssLoad(c),this._cssLoaded=!0);let d=c.requireConfig,e=d&&d.paths;b&&e&&(e.shellcore+=".js?odb_cb="+new Date().toISOString()),as.a.addConfig(c.requireConfig),this._requestShellCore().then(b=>{a.complete(b)},b=>{(b=aE({error:b}))&&"RequireError"===b.resultCode&&this._isDataFromCache?(x.a.logData({name:"SuiteNavProvider.O365ShellCacheFailed"}),this._getSuiteNavShell(a)):this._hasRetriedShell?a.error(b):(this._hasRetriedShell=!0,this._cssLoaded=!1,x.a.logData({name:"SuiteNavProvider.O365ShellRetry"}),this._getSuiteNavShell(a,!0))})})}_requestShellCore(){let a=new h.b,b=requirejs.toUrl("shellcore");return window.require(["shellcore"],()=>{let c=window._o365su;if(c&&c.b)for(let a of["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"])!function(a,b){let c=a[b];"function"==typeof c&&(a[b]=function(...a){try{return c.apply(this,a)}catch(a){p.logData({message:a&&a.message||"",stack:a&&a.stack||"",type:b})}})}(c.b,a);let d=new ao.a;d.Exists()?a.complete(d):a.error(aE({error:{message:"O365Shell not defined after require() succeeded"},resultCode:"O365ShellNotDefined",extraData:{shellUrl:b}}))},c=>{this._capabilities.supportsCaching&&aB(),requirejs.undef("shellcore"),this._modelPromise=void 0,a.error(aE({error:c,resultCode:"RequireError",extraData:{shellUrl:b}}))}),a.getPromise()}_loadModel(a){let b,c;if(!a&&this._modelPromise)return this._modelPromise;let d=this._capabilities.supportsCaching,e=this._dataSource,f=G.b.Failure,g=(0,H.a)(G.a,{name:"SuiteNavProvider.LoadData"},()=>new v.c((c,g)=>{let h,k,l;!a&&d&&this._isCacheValid()&&(h=ay.getValue(au)),h&&h.data?(e.updateDataForCurrentPage&&e.updateDataForCurrentPage(h.data),d&&(k=ay.getValue(ax,j.a.session),l=Date.parse(ay.getValue(av)),i.a.hasStorageType(j.a.session)&&!k||Date.now()-l>=432e5)&&e.loadData().done(aD),this._isDataFromCache=!0,c(h)):(this._isDataFromCache=!1,e.loadData(a).done(a=>{a?a.data?(d&&!aC(a)&&aD(a),c(a)):(b="NoModelData",g("Model with no data returned")):(b="NoModel",g("No model returned"))},a=>{v.c.isCanceled(g)?(b="Canceled",f=G.b.ExpectedFailure):b="ServerLoadFailure",g(a)}))}),null,a=>(v.c.isCanceled(a)&&(f=G.b.ExpectedFailure,b="Canceled"),{resultType:f,resultCode:b||"Other",error:a}));return(c=ab())?this._modelPromise=v.c.all({suiteNavModel:g,theme:c.loadThemeSlotsMap()}).then(a=>{let{suiteNavModel:b,theme:c}=a,d=b&&b.data,e=b&&b.hasCobranding,f=d&&d.UseSPOBehaviors,g=(0,ar.isFeatureEnabled)(ar.SuiteNavPrefersTenantTheme),h=c&&c.suiteBarBackground;return h&&d&&f&&(!e||!g)&&(d.ThemeColors=[h,c.primaryText,h,c.suiteBarText,c.suiteBarDisabledText,c.topBarBackground,c.topBarText,c.topBarHoverText,c.primaryBackground,c.themeLighterAlt,c.dialogBorder]),b}):this._modelPromise=g,this._modelPromise}_isCacheValid(){let a=ay.getValue(au),b=ay.getValue(aw),c=Date.parse(ay.getValue(av)),d=this._capabilities.supportsRealSuiteNav,e=this._dataSource,f=a&&a.data&&(!d||a.requireConfig)&&5===b&&a.userIdentifier===e.getUserIdentifier()&&a.cacheToken===e.getCacheToken()&&!isNaN(c)&&Date.now()-c<864e5;if(!f){let f={model:!!a,"model.data":a&&!!a.data,"model.requireConfig":a&&!!a.requireConfig,supportsRealSuiteNav:d,oldVersion:b,CACHE_VERSION:5,userIsIdentical:a&&a.userIdentifier===e.getUserIdentifier(),cacheToken:a&&a.cacheToken,dataSourceCacheToken:e.getCacheToken(),cacheDate:!isNaN(c),expired:Date.now()-c>=864e5};x.a.logData({name:"SuiteNavCacheDataInvalid",extraData:f})}return f}constructor(a,b){this._dataSource=b.dataSource,this._capabilities=this._dataSource.getCapabilities(),this._cssLoaded=!1}}let aA=(0,ar.isFeatureEnabled)(ar.UnifiedSuiteNavComponent)?(0,k.a)("SuiteNavProvider",am,{dataSource:aq.a,pageContext:at.h}):(0,k.a)("SuiteNavProvider",az,{dataSource:ap.hb});function aB(){ay.remove(au),ay.remove(av),ay.remove(aw),ay.remove(ax,j.a.session)}function aC(a){let b=a&&a.data&&a.data.WorkloadLinks;return!!b&&b.some(a=>a&&!a.Url)}function aD(a){ay.setValue(au,a),ay.setValue(av,new Date),ay.setValue(aw,5),ay.setValue(ax,!0,j.a.session)}function aE(a){let b=a.error;if(b&&b.resultCode)return b;let c=G.b.Failure;return v.c.isCanceled(b)&&(c=G.b.ExpectedFailure,a.resultCode="Canceled"),{resultType:c,resultCode:a.resultCode||"Other",error:b,extraData:a.extraData}}}
,2326:(a,b,c)=>{c.d(b,{a:()=>d});let d=new(c(2)).a("suiteNavV2")}
}]),define("shared-split-bundle~d1f38ee9",[],{});